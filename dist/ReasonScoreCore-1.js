var ReasonScoreCore=function(t){var e={};function n(a){if(e[a])return e[a].exports;var i=e[a]={i:a,l:!1,exports:{}};return t[a].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,a){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(a,i,function(e){return t[e]}.bind(null,i));return a},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}([function(t,e,n){"use strict";n.r(e);var a=class{constructor(t,e){this.topClaimId=t,this.when=new Date,this.notify=e,window.ReasonScore||(window.ReasonScore={}),window.ReasonScore.data?this.data=window.ReasonScore.data:this.data={},window.ReasonScore.TransactionProcessors||(window.ReasonScore.TransactionProcessors=[]),window.ReasonScore.TransactionProcessors.push(this.processTransaction.bind(this))}notify(){}getClaim(t){const e=Object.values(this.data.items).filter(e=>e.id===t&&new Date(e.start)<=this.when&&new Date(e.end)>=this.when);return e.length,e[0]}getArguments(t,e,n){return Object.values(this.data.items).filter(n=>n.parent===t&&new Date(n.start)<=this.when&&new Date(n.end)>this.when&&(e.includes(n.scope)||n.scope===t))}sendTransaction(t){var e=this.newId(),n=(new Date).toJSON();for(const a of t)a.ver=this.newId(),a.trans=e,a.start=n;for(const e of window.ReasonScore.TransactionProcessors)e(t)}processTransaction(t){const e=this.data.items;for(const n of t)e[n.ver]={...n.old,...n.new,ver:n.ver,start:n.start,end:"3000-01-01T00:00:00.000Z"},n.old&&(e[n.old.ver]={...n.old,end:n.start}),this.when=new Date(n.start),this.notify()}newId(){let t=5e12-new Date;const e="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".split("");let n="";for(;t>=1;)n=e[t-62*Math.floor(t/62)]+n,t=Math.floor(t/62);return n+=Array(5).join().split(",").map(()=>e[Math.floor(Math.random()*e.length)]).join("")}};var i=class{static calculateReasonScore(t,e,n,a){let i={};return i=a?JSON.parse(JSON.stringify(a)):{claimId:t,relevance:1,strengthTotal:0,weightTotal:0},(void 0===e||e.length<1||e.filter(t=>"truth"===t.affects).length<1)&&(i.strengthTotal=1,i.weightTotal=1),e.forEach(t=>{const e=n.filter(e=>e.claimId===t.child)[0];"truth"===t.affects&&(t.reversable?e.weight=e.score*e.relevance:e.weight=Math.max(0,e.score)*e.relevance,i.weightTotal+=e.weight,t.pro?e.strength=e.weight*e.score:e.strength=e.weight*-e.score,i.strengthTotal+=e.strength,e.display=`${Math.round(100*e.weight)}%`),"relevance"===t.affects&&(t.pro?e.relevance=1+e.score:e.relevance=1-e.score/2,i.relevance*=e.relevance,e.display=`X${e.relevance}`)}),0===i.weightTotal?i.score=0:i.score=i.strengthTotal/i.weightTotal,i.display=`${Math.round(100*i.score)}%`,i}};var o=class{constructor(t,e){this.setState=t,this.topClaimId=e,this.data=new a(e,this.updateState.bind(this)),this.state={vm:this.buildViewModel(this.topClaimId,this.topClaimId,[]),data:this.data}}updateState(){this.setState({vm:this.buildViewModel(this.topClaimId,this.topClaimId,[])})}onSelect(t){this.selectedVm=t,this.setState({vm:this.buildViewModel(this.topClaimId,this.topClaimId,[])})}newChild(t,e){var n={type:"claim",id:this.data.newId(),content:""},a={type:"argument",id:this.data.newId(),parent:t.claim.id,child:n.id,scope:t.claim.id,pro:e,affects:"truth"};this.data.sendTransaction([{id:n.id,act:"add",new:n},{id:a.id,act:"add",new:a}])}buildViewModel(t,e,n,a){const o=this.data.getArguments(e,n),r=[],s=[],c=[];o.forEach(i=>{const o=n.slice();o.push(e);const s=this.buildViewModel(t,i.child,o,i.pro?a:!a);s.argument=i,r.push(s)});const d={id:"",topId:t,childId:e,children:[]};return d.id=n.join("/"),d.id.length>0&&(d.id+="/"),d.id+=e,r.forEach(t=>{s.push(t.score),t.score.id||(t.score.id=this.data.newId()),c.push({scoreId:t.score.id,claimId:t.claimId})}),d.score=i.calculateReasonScore(e,o,s),d.children=r,d.childIds=c,d.conTop=a,d.className="claim"+(d.conTop?" con":" pro"),d.claim=this.data.getClaim(e),d.content=d.claim.content,this.selectedVm&&d.id===this.selectedVm.id?(d.selected=!0,d.unSelect=(()=>this.onSelect())):d.onSelect=(()=>this.onSelect(d)),d.increase=(()=>this.newChild(d,!0)),d.decrease=(()=>this.newChild(d,!1)),d.sendTransaction=this.data.sendTransaction.bind(this.data),d}};n.d(e,"data",function(){return a}),n.d(e,"ReasonScoreMath",function(){return i}),n.d(e,"ViewModelbuilder",function(){return o})}]);