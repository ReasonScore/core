"use strict";

var _Repository = require("../Repository");

var _CalculationLooper = require("../CalculationLooper");

var _Change = require("../dataModels/Change");

var _Claim = require("../dataModels/Claim");

var _Id = require("../dataModels/Id");

var _ClaimEdge = require("../dataModels/ClaimEdge");

test('City 3000 1 level scope', function () {
  var repo = new _Repository.Repository();
  var calculationLoop = new _CalculationLooper.CalculationLooper(repo);
  calculationLoop.notify([new _Change.Change(new _Claim.Claim("Measured Claim", (0, _Id.ID)("0"))), new _Change.Change(new _Claim.Claim("Con with scope of X", (0, _Id.ID)("1"))), new _Change.Change(new _ClaimEdge.ClaimEdge((0, _Id.ID)("0"), (0, _Id.ID)("1"), (0, _Id.ID)("X"), undefined, false, (0, _Id.ID)("1-X"))), new _Change.Change(new _Claim.Claim("Con with scope of Y", (0, _Id.ID)("2"))), new _Change.Change(new _ClaimEdge.ClaimEdge((0, _Id.ID)("0"), (0, _Id.ID)("2"), (0, _Id.ID)("Y"), undefined, false, (0, _Id.ID)("2-Y")))]);
  expect(repo.getScoreByClaimIdAndScope((0, _Id.ID)("0"), (0, _Id.ID)("X")).confidence).toBe(-1);
  expect(repo.getScoreByClaimIdAndScope((0, _Id.ID)("0"), (0, _Id.ID)("Y")).confidence).toBe(-1);
  expect(repo.getScoreByClaimIdAndScope((0, _Id.ID)("0"), (0, _Id.ID)("0")).confidence).toBe(1); //Add one with a scope of x to the top and see if it gets the 0 scope or the x scope

  calculationLoop.notify([new _Change.Change(new _Claim.Claim("Top X Scope Claim", (0, _Id.ID)("-1"))), new _Change.Change(new _ClaimEdge.ClaimEdge((0, _Id.ID)("-1"), (0, _Id.ID)("0"), (0, _Id.ID)("X"), undefined, true, (0, _Id.ID)("2-Y")))]);
  debugger;
  expect(repo.getScoreByClaimIdAndScope((0, _Id.ID)("-1"), (0, _Id.ID)("X")).confidence).toBe(-1);
  expect(repo.getScoreByClaimIdAndScope((0, _Id.ID)("-1"), (0, _Id.ID)("-1")).confidence).toBe(-1);
}); // test('City 300 listen to changes then calculate', () => {
//     const repo = new Repository();
//     const calculationLoop = new CalculationLooper(repo);
//     calculationLoop.notify([new Change(new Claim("test", ID("2")))]);
//     expect(repo.getScoreByClaimIdAndScope(ID("2"), ID("2")).confidence).toBe(1);
//     calculationLoop.notify([new Change(new Claim("The City 3000 Plan is worth the investment", ID("2")))]);
//     expect(repo.items["2"].length).toBe(2);
//     calculationLoop.notify([
//         new Change(new Claim("The City 3000 plan is expensive", ID("4"))),
//         new Change(new ClaimEdge(ID("2"), ID("4"), ID("2"), undefined, false, ID("2-4"))),
//     ]);
//     expect(repo.getScoresByClaimId(ID("2"))[0].confidence).toBe(-1);
//     calculationLoop.notify([
//         new Change(new Claim("Bike lanes benefit residents", ID("3"))),
//         new Change(new ClaimEdge(ID("2"), ID("3"), ID("2"), undefined, true, ID("2-3"))),
//     ]);
//     expect(repo.getScoresByClaimId(ID("2"))[0].confidence).toBe(0);
//     debugger;
//     calculationLoop.notify([
//         new Change(new Claim("Arctic City Should Implement the City 3000 plan", ID("0"))),
//         new Change(new Claim("Bikes are not recommended in minus 30 degree weather", ID("6"))),
//         new Change(new Claim("Subways benefit residents", ID("5"))),
//         new Change(new ClaimEdge(ID("0"), ID("2"), ID("0"), undefined, true, ID("0-2"))),
//         new Change(new ClaimEdge(ID("2"), ID("5"), ID("2"), undefined, false, ID("0-2-3-5"))),
//         new Change(new ClaimEdge(ID("3"), ID("6"), ID("0"), undefined, false, ID("0-2-3-6"))),
//     ]);
//     //TODO: Remove later: this tests manually propogating hte change up the stack
//     calculationLoop.notify([
//         new Change(new ClaimEdge(ID("2"), ID("3"), ID("0"), undefined, true, ID("0-2-3"))),
//         new Change(new ClaimEdge(ID("0"), ID("2"), ID("0"), undefined, true, ID("0-2"))),
//     ]);
//     //expect(repo.getScoresByClaimId(ID("2"))[0].confidence).toBe(0);
//     debugger;
//     expect(repo.getScoresByClaimId(ID("0"))[0].confidence).toBe(-1 / 3);
// });
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy90ZXN0cy9MaXN0ZW5UaGVuQ2FsY3VsYXRlLnRlc3QudHMiXSwibmFtZXMiOlsidGVzdCIsInJlcG8iLCJSZXBvc2l0b3J5IiwiY2FsY3VsYXRpb25Mb29wIiwiQ2FsY3VsYXRpb25Mb29wZXIiLCJub3RpZnkiLCJDaGFuZ2UiLCJDbGFpbSIsIkNsYWltRWRnZSIsInVuZGVmaW5lZCIsImV4cGVjdCIsImdldFNjb3JlQnlDbGFpbUlkQW5kU2NvcGUiLCJjb25maWRlbmNlIiwidG9CZSJdLCJtYXBwaW5ncyI6Ijs7QUFBQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFHQUEsSUFBSSxDQUFDLHlCQUFELEVBQTRCLFlBQU07QUFDbEMsTUFBTUMsSUFBSSxHQUFHLElBQUlDLHNCQUFKLEVBQWI7QUFDQSxNQUFNQyxlQUFlLEdBQUcsSUFBSUMsb0NBQUosQ0FBc0JILElBQXRCLENBQXhCO0FBRUFFLEVBQUFBLGVBQWUsQ0FBQ0UsTUFBaEIsQ0FBdUIsQ0FDbkIsSUFBSUMsY0FBSixDQUFXLElBQUlDLFlBQUosQ0FBVSxnQkFBVixFQUE0QixZQUFHLEdBQUgsQ0FBNUIsQ0FBWCxDQURtQixFQUVuQixJQUFJRCxjQUFKLENBQVcsSUFBSUMsWUFBSixDQUFVLHFCQUFWLEVBQWlDLFlBQUcsR0FBSCxDQUFqQyxDQUFYLENBRm1CLEVBR25CLElBQUlELGNBQUosQ0FBVyxJQUFJRSxvQkFBSixDQUFjLFlBQUcsR0FBSCxDQUFkLEVBQXVCLFlBQUcsR0FBSCxDQUF2QixFQUFnQyxZQUFHLEdBQUgsQ0FBaEMsRUFBeUNDLFNBQXpDLEVBQW9ELEtBQXBELEVBQTJELFlBQUcsS0FBSCxDQUEzRCxDQUFYLENBSG1CLEVBSW5CLElBQUlILGNBQUosQ0FBVyxJQUFJQyxZQUFKLENBQVUscUJBQVYsRUFBaUMsWUFBRyxHQUFILENBQWpDLENBQVgsQ0FKbUIsRUFLbkIsSUFBSUQsY0FBSixDQUFXLElBQUlFLG9CQUFKLENBQWMsWUFBRyxHQUFILENBQWQsRUFBdUIsWUFBRyxHQUFILENBQXZCLEVBQWdDLFlBQUcsR0FBSCxDQUFoQyxFQUF5Q0MsU0FBekMsRUFBb0QsS0FBcEQsRUFBMkQsWUFBRyxLQUFILENBQTNELENBQVgsQ0FMbUIsQ0FBdkI7QUFPQUMsRUFBQUEsTUFBTSxDQUFDVCxJQUFJLENBQUNVLHlCQUFMLENBQStCLFlBQUcsR0FBSCxDQUEvQixFQUF3QyxZQUFHLEdBQUgsQ0FBeEMsRUFBaURDLFVBQWxELENBQU4sQ0FBb0VDLElBQXBFLENBQXlFLENBQUMsQ0FBMUU7QUFDQUgsRUFBQUEsTUFBTSxDQUFDVCxJQUFJLENBQUNVLHlCQUFMLENBQStCLFlBQUcsR0FBSCxDQUEvQixFQUF3QyxZQUFHLEdBQUgsQ0FBeEMsRUFBaURDLFVBQWxELENBQU4sQ0FBb0VDLElBQXBFLENBQXlFLENBQUMsQ0FBMUU7QUFDQUgsRUFBQUEsTUFBTSxDQUFDVCxJQUFJLENBQUNVLHlCQUFMLENBQStCLFlBQUcsR0FBSCxDQUEvQixFQUF3QyxZQUFHLEdBQUgsQ0FBeEMsRUFBaURDLFVBQWxELENBQU4sQ0FBb0VDLElBQXBFLENBQXlFLENBQXpFLEVBYmtDLENBZWxDOztBQUNBVixFQUFBQSxlQUFlLENBQUNFLE1BQWhCLENBQXVCLENBQ25CLElBQUlDLGNBQUosQ0FBVyxJQUFJQyxZQUFKLENBQVUsbUJBQVYsRUFBK0IsWUFBRyxJQUFILENBQS9CLENBQVgsQ0FEbUIsRUFFbkIsSUFBSUQsY0FBSixDQUFXLElBQUlFLG9CQUFKLENBQWMsWUFBRyxJQUFILENBQWQsRUFBd0IsWUFBRyxHQUFILENBQXhCLEVBQWlDLFlBQUcsR0FBSCxDQUFqQyxFQUEwQ0MsU0FBMUMsRUFBcUQsSUFBckQsRUFBMkQsWUFBRyxLQUFILENBQTNELENBQVgsQ0FGbUIsQ0FBdkI7QUFJQTtBQUNBQyxFQUFBQSxNQUFNLENBQUNULElBQUksQ0FBQ1UseUJBQUwsQ0FBK0IsWUFBRyxJQUFILENBQS9CLEVBQXlDLFlBQUcsR0FBSCxDQUF6QyxFQUFrREMsVUFBbkQsQ0FBTixDQUFxRUMsSUFBckUsQ0FBMEUsQ0FBQyxDQUEzRTtBQUNBSCxFQUFBQSxNQUFNLENBQUNULElBQUksQ0FBQ1UseUJBQUwsQ0FBK0IsWUFBRyxJQUFILENBQS9CLEVBQXlDLFlBQUcsSUFBSCxDQUF6QyxFQUFtREMsVUFBcEQsQ0FBTixDQUFzRUMsSUFBdEUsQ0FBMkUsQ0FBQyxDQUE1RTtBQUNILENBdkJHLENBQUosQyxDQTJCQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgUmVwb3NpdG9yeSB9IGZyb20gXCIuLi9SZXBvc2l0b3J5XCI7XHJcbmltcG9ydCB7IENhbGN1bGF0aW9uTG9vcGVyIH0gZnJvbSBcIi4uL0NhbGN1bGF0aW9uTG9vcGVyXCI7XHJcbmltcG9ydCB7IENoYW5nZSB9IGZyb20gXCIuLi9kYXRhTW9kZWxzL0NoYW5nZVwiO1xyXG5pbXBvcnQgeyBDbGFpbSB9IGZyb20gXCIuLi9kYXRhTW9kZWxzL0NsYWltXCI7XHJcbmltcG9ydCB7IElEIH0gZnJvbSBcIi4uL2RhdGFNb2RlbHMvSWRcIjtcclxuaW1wb3J0IHsgQ2xhaW1FZGdlIH0gZnJvbSBcIi4uL2RhdGFNb2RlbHMvQ2xhaW1FZGdlXCI7XHJcblxyXG5cclxudGVzdCgnQ2l0eSAzMDAwIDEgbGV2ZWwgc2NvcGUnLCAoKSA9PiB7XHJcbiAgICBjb25zdCByZXBvID0gbmV3IFJlcG9zaXRvcnkoKTtcclxuICAgIGNvbnN0IGNhbGN1bGF0aW9uTG9vcCA9IG5ldyBDYWxjdWxhdGlvbkxvb3BlcihyZXBvKTtcclxuXHJcbiAgICBjYWxjdWxhdGlvbkxvb3Aubm90aWZ5KFtcclxuICAgICAgICBuZXcgQ2hhbmdlKG5ldyBDbGFpbShcIk1lYXN1cmVkIENsYWltXCIsIElEKFwiMFwiKSkpLFxyXG4gICAgICAgIG5ldyBDaGFuZ2UobmV3IENsYWltKFwiQ29uIHdpdGggc2NvcGUgb2YgWFwiLCBJRChcIjFcIikpKSxcclxuICAgICAgICBuZXcgQ2hhbmdlKG5ldyBDbGFpbUVkZ2UoSUQoXCIwXCIpLCBJRChcIjFcIiksIElEKFwiWFwiKSwgdW5kZWZpbmVkLCBmYWxzZSwgSUQoXCIxLVhcIikpKSxcclxuICAgICAgICBuZXcgQ2hhbmdlKG5ldyBDbGFpbShcIkNvbiB3aXRoIHNjb3BlIG9mIFlcIiwgSUQoXCIyXCIpKSksXHJcbiAgICAgICAgbmV3IENoYW5nZShuZXcgQ2xhaW1FZGdlKElEKFwiMFwiKSwgSUQoXCIyXCIpLCBJRChcIllcIiksIHVuZGVmaW5lZCwgZmFsc2UsIElEKFwiMi1ZXCIpKSksXHJcbiAgICBdKTtcclxuICAgIGV4cGVjdChyZXBvLmdldFNjb3JlQnlDbGFpbUlkQW5kU2NvcGUoSUQoXCIwXCIpLCBJRChcIlhcIikpLmNvbmZpZGVuY2UpLnRvQmUoLTEpO1xyXG4gICAgZXhwZWN0KHJlcG8uZ2V0U2NvcmVCeUNsYWltSWRBbmRTY29wZShJRChcIjBcIiksIElEKFwiWVwiKSkuY29uZmlkZW5jZSkudG9CZSgtMSk7XHJcbiAgICBleHBlY3QocmVwby5nZXRTY29yZUJ5Q2xhaW1JZEFuZFNjb3BlKElEKFwiMFwiKSwgSUQoXCIwXCIpKS5jb25maWRlbmNlKS50b0JlKDEpO1xyXG5cclxuICAgIC8vQWRkIG9uZSB3aXRoIGEgc2NvcGUgb2YgeCB0byB0aGUgdG9wIGFuZCBzZWUgaWYgaXQgZ2V0cyB0aGUgMCBzY29wZSBvciB0aGUgeCBzY29wZVxyXG4gICAgY2FsY3VsYXRpb25Mb29wLm5vdGlmeShbXHJcbiAgICAgICAgbmV3IENoYW5nZShuZXcgQ2xhaW0oXCJUb3AgWCBTY29wZSBDbGFpbVwiLCBJRChcIi0xXCIpKSksXHJcbiAgICAgICAgbmV3IENoYW5nZShuZXcgQ2xhaW1FZGdlKElEKFwiLTFcIiksIElEKFwiMFwiKSwgSUQoXCJYXCIpLCB1bmRlZmluZWQsIHRydWUsIElEKFwiMi1ZXCIpKSksXHJcbiAgICBdKTtcclxuICAgIGRlYnVnZ2VyO1xyXG4gICAgZXhwZWN0KHJlcG8uZ2V0U2NvcmVCeUNsYWltSWRBbmRTY29wZShJRChcIi0xXCIpLCBJRChcIlhcIikpLmNvbmZpZGVuY2UpLnRvQmUoLTEpO1xyXG4gICAgZXhwZWN0KHJlcG8uZ2V0U2NvcmVCeUNsYWltSWRBbmRTY29wZShJRChcIi0xXCIpLCBJRChcIi0xXCIpKS5jb25maWRlbmNlKS50b0JlKC0xKTtcclxufSk7XHJcblxyXG5cclxuXHJcbi8vIHRlc3QoJ0NpdHkgMzAwIGxpc3RlbiB0byBjaGFuZ2VzIHRoZW4gY2FsY3VsYXRlJywgKCkgPT4ge1xyXG4vLyAgICAgY29uc3QgcmVwbyA9IG5ldyBSZXBvc2l0b3J5KCk7XHJcbi8vICAgICBjb25zdCBjYWxjdWxhdGlvbkxvb3AgPSBuZXcgQ2FsY3VsYXRpb25Mb29wZXIocmVwbyk7XHJcblxyXG4vLyAgICAgY2FsY3VsYXRpb25Mb29wLm5vdGlmeShbbmV3IENoYW5nZShuZXcgQ2xhaW0oXCJ0ZXN0XCIsIElEKFwiMlwiKSkpXSk7XHJcbi8vICAgICBleHBlY3QocmVwby5nZXRTY29yZUJ5Q2xhaW1JZEFuZFNjb3BlKElEKFwiMlwiKSwgSUQoXCIyXCIpKS5jb25maWRlbmNlKS50b0JlKDEpO1xyXG5cclxuLy8gICAgIGNhbGN1bGF0aW9uTG9vcC5ub3RpZnkoW25ldyBDaGFuZ2UobmV3IENsYWltKFwiVGhlIENpdHkgMzAwMCBQbGFuIGlzIHdvcnRoIHRoZSBpbnZlc3RtZW50XCIsIElEKFwiMlwiKSkpXSk7XHJcbi8vICAgICBleHBlY3QocmVwby5pdGVtc1tcIjJcIl0ubGVuZ3RoKS50b0JlKDIpO1xyXG5cclxuLy8gICAgIGNhbGN1bGF0aW9uTG9vcC5ub3RpZnkoW1xyXG4vLyAgICAgICAgIG5ldyBDaGFuZ2UobmV3IENsYWltKFwiVGhlIENpdHkgMzAwMCBwbGFuIGlzIGV4cGVuc2l2ZVwiLCBJRChcIjRcIikpKSxcclxuLy8gICAgICAgICBuZXcgQ2hhbmdlKG5ldyBDbGFpbUVkZ2UoSUQoXCIyXCIpLCBJRChcIjRcIiksIElEKFwiMlwiKSwgdW5kZWZpbmVkLCBmYWxzZSwgSUQoXCIyLTRcIikpKSxcclxuLy8gICAgIF0pO1xyXG5cclxuLy8gICAgIGV4cGVjdChyZXBvLmdldFNjb3Jlc0J5Q2xhaW1JZChJRChcIjJcIikpWzBdLmNvbmZpZGVuY2UpLnRvQmUoLTEpO1xyXG5cclxuLy8gICAgIGNhbGN1bGF0aW9uTG9vcC5ub3RpZnkoW1xyXG4vLyAgICAgICAgIG5ldyBDaGFuZ2UobmV3IENsYWltKFwiQmlrZSBsYW5lcyBiZW5lZml0IHJlc2lkZW50c1wiLCBJRChcIjNcIikpKSxcclxuLy8gICAgICAgICBuZXcgQ2hhbmdlKG5ldyBDbGFpbUVkZ2UoSUQoXCIyXCIpLCBJRChcIjNcIiksIElEKFwiMlwiKSwgdW5kZWZpbmVkLCB0cnVlLCBJRChcIjItM1wiKSkpLFxyXG4vLyAgICAgXSk7XHJcblxyXG4vLyAgICAgZXhwZWN0KHJlcG8uZ2V0U2NvcmVzQnlDbGFpbUlkKElEKFwiMlwiKSlbMF0uY29uZmlkZW5jZSkudG9CZSgwKTtcclxuXHJcbi8vICAgICBkZWJ1Z2dlcjtcclxuLy8gICAgIGNhbGN1bGF0aW9uTG9vcC5ub3RpZnkoW1xyXG4vLyAgICAgICAgIG5ldyBDaGFuZ2UobmV3IENsYWltKFwiQXJjdGljIENpdHkgU2hvdWxkIEltcGxlbWVudCB0aGUgQ2l0eSAzMDAwIHBsYW5cIiwgSUQoXCIwXCIpKSksXHJcbi8vICAgICAgICAgbmV3IENoYW5nZShuZXcgQ2xhaW0oXCJCaWtlcyBhcmUgbm90IHJlY29tbWVuZGVkIGluIG1pbnVzIDMwIGRlZ3JlZSB3ZWF0aGVyXCIsIElEKFwiNlwiKSkpLFxyXG4vLyAgICAgICAgIG5ldyBDaGFuZ2UobmV3IENsYWltKFwiU3Vid2F5cyBiZW5lZml0IHJlc2lkZW50c1wiLCBJRChcIjVcIikpKSxcclxuLy8gICAgICAgICBuZXcgQ2hhbmdlKG5ldyBDbGFpbUVkZ2UoSUQoXCIwXCIpLCBJRChcIjJcIiksIElEKFwiMFwiKSwgdW5kZWZpbmVkLCB0cnVlLCBJRChcIjAtMlwiKSkpLFxyXG4vLyAgICAgICAgIG5ldyBDaGFuZ2UobmV3IENsYWltRWRnZShJRChcIjJcIiksIElEKFwiNVwiKSwgSUQoXCIyXCIpLCB1bmRlZmluZWQsIGZhbHNlLCBJRChcIjAtMi0zLTVcIikpKSxcclxuLy8gICAgICAgICBuZXcgQ2hhbmdlKG5ldyBDbGFpbUVkZ2UoSUQoXCIzXCIpLCBJRChcIjZcIiksIElEKFwiMFwiKSwgdW5kZWZpbmVkLCBmYWxzZSwgSUQoXCIwLTItMy02XCIpKSksXHJcbi8vICAgICBdKTtcclxuXHJcbi8vICAgICAvL1RPRE86IFJlbW92ZSBsYXRlcjogdGhpcyB0ZXN0cyBtYW51YWxseSBwcm9wb2dhdGluZyBodGUgY2hhbmdlIHVwIHRoZSBzdGFja1xyXG4vLyAgICAgY2FsY3VsYXRpb25Mb29wLm5vdGlmeShbXHJcbi8vICAgICAgICAgbmV3IENoYW5nZShuZXcgQ2xhaW1FZGdlKElEKFwiMlwiKSwgSUQoXCIzXCIpLCBJRChcIjBcIiksIHVuZGVmaW5lZCwgdHJ1ZSwgSUQoXCIwLTItM1wiKSkpLFxyXG4vLyAgICAgICAgIG5ldyBDaGFuZ2UobmV3IENsYWltRWRnZShJRChcIjBcIiksIElEKFwiMlwiKSwgSUQoXCIwXCIpLCB1bmRlZmluZWQsIHRydWUsIElEKFwiMC0yXCIpKSksXHJcbi8vICAgICBdKTtcclxuXHJcbi8vICAgICAvL2V4cGVjdChyZXBvLmdldFNjb3Jlc0J5Q2xhaW1JZChJRChcIjJcIikpWzBdLmNvbmZpZGVuY2UpLnRvQmUoMCk7XHJcbi8vICAgICBkZWJ1Z2dlcjtcclxuLy8gICAgIGV4cGVjdChyZXBvLmdldFNjb3Jlc0J5Q2xhaW1JZChJRChcIjBcIikpWzBdLmNvbmZpZGVuY2UpLnRvQmUoLTEgLyAzKTtcclxuXHJcbi8vIH0pO1xyXG5cclxuXHJcblxyXG5cclxuXHJcbiJdfQ==