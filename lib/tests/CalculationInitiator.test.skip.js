"use strict";

var _CalculationInitiator = require("../CalculationInitiator");

var _Change = require("../dataModels/Change");

var _Claim = require("../dataModels/Claim");

var _Id = require("../dataModels/Id");

var _ClaimEdge = require("../dataModels/ClaimEdge");

var _Repository = require("../Repository");

var _Affects = require("../dataModels/Affects");

test('claim without any edges should have score of 1', function () {
  var repo = new _Repository.Repository();
  var calcInitator = new _CalculationInitiator.CalculationInitator(repo);
  var claim = new _Claim.Claim("Measured Claim", (0, _Id.ID)("0"));
  calcInitator.notify([new _Change.Change(claim)]);
  expect(repo.getScoreBySourceClaimId(claim.id).sourceClaimId).toBe(claim.id);
  expect(repo.getScoreBySourceClaimId(claim.id).confidence).toBe(1);
});
test('claim with two con descendants should have a confidence of 0', function () {
  var repo = new _Repository.Repository();
  var calcInitator = new _CalculationInitiator.CalculationInitator(repo);
  var measuredClaim = new _Claim.Claim("Measured Claim", (0, _Id.ID)("measuredClaim"));
  var childClaim1 = new _Claim.Claim("Child Claim 1", (0, _Id.ID)("childClaim1"));
  var descendantClaim = new _Claim.Claim("Descendant Claim", (0, _Id.ID)("descendantClaim"));
  calcInitator.notify([new _Change.Change(measuredClaim), new _Change.Change(childClaim1), new _Change.Change(descendantClaim), new _Change.Change(new _ClaimEdge.ClaimEdge(measuredClaim.id, childClaim1.id, _Affects.Affects.Confidence, false)), new _Change.Change(new _ClaimEdge.ClaimEdge(childClaim1.id, descendantClaim.id, _Affects.Affects.Confidence, false))]);
  expect(repo.getScoreBySourceClaimId(measuredClaim.id).confidence).toBe(0);
});
test('claim with two con descendants and other children should have a confidence of 1', function () {
  var repo = new _Repository.Repository();
  var calcInitator = new _CalculationInitiator.CalculationInitator(repo);
  var measuredClaim = new _Claim.Claim("Measured Claim", (0, _Id.ID)("measuredClaim"));
  var childClaim1 = new _Claim.Claim("Child Claim 1", (0, _Id.ID)("childClaim1"));
  var childClaim2 = new _Claim.Claim("Child Claim 2", (0, _Id.ID)("childClaim2"));
  var descendantClaim = new _Claim.Claim("Descendant Claim", (0, _Id.ID)("descendantClaim"));
  calcInitator.notify([new _Change.Change(measuredClaim), new _Change.Change(childClaim1), new _Change.Change(descendantClaim), new _Change.Change(new _ClaimEdge.ClaimEdge(measuredClaim.id, childClaim1.id, _Affects.Affects.Confidence, false)), new _Change.Change(new _ClaimEdge.ClaimEdge(measuredClaim.id, childClaim2.id, _Affects.Affects.Confidence, true)), new _Change.Change(new _ClaimEdge.ClaimEdge(childClaim1.id, descendantClaim.id, _Affects.Affects.Confidence, false))]);
  expect(repo.getScoreBySourceClaimId(measuredClaim.id).confidence).toBe(1);
});
test('Multiple children calculation', function () {
  var repo = new _Repository.Repository();
  var calcInitator = new _CalculationInitiator.CalculationInitator(repo);
  var measuredClaim = new _Claim.Claim("Measured Claim", (0, _Id.ID)("measuredClaim"));
  var childClaim1 = new _Claim.Claim("Child Claim 1", (0, _Id.ID)("childClaim1"));
  var childClaim2 = new _Claim.Claim("Child Claim 2", (0, _Id.ID)("childClaim2"));
  var descendantClaim = new _Claim.Claim("Descendant Claim", (0, _Id.ID)("descendantClaim"));
  calcInitator.notify([new _Change.Change(measuredClaim), new _Change.Change(childClaim1), new _Change.Change(childClaim2), new _Change.Change(descendantClaim), new _Change.Change(new _ClaimEdge.ClaimEdge(measuredClaim.id, childClaim1.id, _Affects.Affects.Confidence, false)), new _Change.Change(new _ClaimEdge.ClaimEdge(measuredClaim.id, childClaim2.id, _Affects.Affects.Confidence, false)), new _Change.Change(new _ClaimEdge.ClaimEdge(childClaim1.id, descendantClaim.id, _Affects.Affects.Confidence, false))]);
  expect(repo.getScoreBySourceClaimId(measuredClaim.id).confidence).toBe(0);
});
test('Default Not Reversable', function () {
  var repo = new _Repository.Repository();
  var calcInitator = new _CalculationInitiator.CalculationInitator(repo);
  var measuredClaim = new _Claim.Claim("Measured Claim", (0, _Id.ID)("measuredClaim"));
  var childClaim1 = new _Claim.Claim("Child Claim 1", (0, _Id.ID)("childClaim1"));
  calcInitator.notify([new _Change.Change(measuredClaim), new _Change.Change(childClaim1), new _Change.Change(new _ClaimEdge.ClaimEdge(measuredClaim.id, childClaim1.id, _Affects.Affects.Confidence, false))]);
  expect(repo.getScoreBySourceClaimId(measuredClaim.id).confidence).toBe(0);
});
test('Reversable', function () {
  var repo = new _Repository.Repository();
  var calcInitator = new _CalculationInitiator.CalculationInitator(repo);
  var measuredClaim = new _Claim.Claim("Measured Claim", (0, _Id.ID)("measuredClaim"), undefined, undefined, undefined, true);
  var childClaim1 = new _Claim.Claim("Child Claim 1", (0, _Id.ID)("childClaim1"));
  calcInitator.notify([new _Change.Change(measuredClaim), new _Change.Change(childClaim1), new _Change.Change(new _ClaimEdge.ClaimEdge(measuredClaim.id, childClaim1.id, _Affects.Affects.Confidence, false))]);
  expect(repo.getScoreBySourceClaimId(measuredClaim.id).confidence).toBe(-1);
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy90ZXN0cy9DYWxjdWxhdGlvbkluaXRpYXRvci50ZXN0LnNraXAudHMiXSwibmFtZXMiOlsidGVzdCIsInJlcG8iLCJSZXBvc2l0b3J5IiwiY2FsY0luaXRhdG9yIiwiQ2FsY3VsYXRpb25Jbml0YXRvciIsImNsYWltIiwiQ2xhaW0iLCJub3RpZnkiLCJDaGFuZ2UiLCJleHBlY3QiLCJnZXRTY29yZUJ5U291cmNlQ2xhaW1JZCIsImlkIiwic291cmNlQ2xhaW1JZCIsInRvQmUiLCJjb25maWRlbmNlIiwibWVhc3VyZWRDbGFpbSIsImNoaWxkQ2xhaW0xIiwiZGVzY2VuZGFudENsYWltIiwiQ2xhaW1FZGdlIiwiQWZmZWN0cyIsIkNvbmZpZGVuY2UiLCJjaGlsZENsYWltMiIsInVuZGVmaW5lZCJdLCJtYXBwaW5ncyI6Ijs7QUFBQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFHQUEsSUFBSSxDQUFDLGdEQUFELEVBQW1ELFlBQU07QUFDekQsTUFBTUMsSUFBSSxHQUFHLElBQUlDLHNCQUFKLEVBQWI7QUFDQSxNQUFNQyxZQUFZLEdBQUcsSUFBSUMseUNBQUosQ0FBd0JILElBQXhCLENBQXJCO0FBQ0EsTUFBTUksS0FBSyxHQUFHLElBQUlDLFlBQUosQ0FBVSxnQkFBVixFQUE0QixZQUFHLEdBQUgsQ0FBNUIsQ0FBZDtBQUNBSCxFQUFBQSxZQUFZLENBQUNJLE1BQWIsQ0FBb0IsQ0FDaEIsSUFBSUMsY0FBSixDQUFXSCxLQUFYLENBRGdCLENBQXBCO0FBR0FJLEVBQUFBLE1BQU0sQ0FBQ1IsSUFBSSxDQUFDUyx1QkFBTCxDQUE2QkwsS0FBSyxDQUFDTSxFQUFuQyxFQUF1Q0MsYUFBeEMsQ0FBTixDQUE2REMsSUFBN0QsQ0FBa0VSLEtBQUssQ0FBQ00sRUFBeEU7QUFDQUYsRUFBQUEsTUFBTSxDQUFDUixJQUFJLENBQUNTLHVCQUFMLENBQTZCTCxLQUFLLENBQUNNLEVBQW5DLEVBQXVDRyxVQUF4QyxDQUFOLENBQTBE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LENBQXVFLENBQXZFO0FBQ0gsQ0FYRyxDQUFKO0FBYUFiLElBQUksQ0FBQyxZQUFELEVBQWUsWUFBTTtBQUNyQixNQUFNQyxJQUFJLEdBQUcsSUFBSUMsc0JBQUosRUFBYjtBQUNBLE1BQU1DLFlBQVksR0FBRyxJQUFJQyx5Q0FBSixDQUF3QkgsSUFBeEIsQ0FBckI7QUFDQSxNQUFNYyxhQUFhLEdBQUcsSUFBSVQsWUFBSixDQUFVLGdCQUFWLEVBQTRCLFlBQUcsZUFBSCxDQUE1QixFQUFpRGdCLFNBQWpELEVBQTREQSxTQUE1RCxFQUF1RUEsU0FBdkUsRUFBa0YsSUFBbEYsQ0FBdEI7QUFDQSxNQUFNTixXQUFXLEdBQUcsSUFBSVYsWUFBSixDQUFVLGVBQVYsRUFBMkIsWUFBRyxhQUFILENBQTNCLENBQXBCO0FBQ0FILEVBQUFBLFlBQVksQ0FBQ0ksTUFBYixDQUFvQixDQUNoQixJQUFJQyxjQUFKLENBQVdPLGFBQVgsQ0FEZ0IsRUFFaEIsSUFBSVAsY0FBSixDQUFXUSxXQUFYLENBRmdCLEVBR2hCLElBQUlSLGNBQUosQ0FBVyxJQUFJVSxvQkFBSixDQUFjSCxhQUFhLENBQUNKLEVBQTVCLEVBQWdDSyxXQUFXLENBQUNMLEVBQTVDLEVBQWdEUSxpQkFBUUMsVUFBeEQsRUFBb0UsS0FBcEUsQ0FBWCxDQUhnQixDQUFwQjtBQUtBWCxFQUFBQSxNQUFNLENBQUNSLElBQUksQ0FBQ1MsdUJBQUwsQ0FBNkJLLGFBQWEsQ0FBQ0osRUFBM0MsRUFBK0NHLFVBQWhELENBQU4sQ0FBa0VELElBQWxFLENBQXVFLENBQUMsQ0FBeEU7QUFDSCxDQVhHLENBQUoiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDYWxjdWxhdGlvbkluaXRhdG9yIH0gZnJvbSBcIi4uL0NhbGN1bGF0aW9uSW5pdGlhdG9yXCI7XHJcbmltcG9ydCB7IENoYW5nZSB9IGZyb20gXCIuLi9kYXRhTW9kZWxzL0NoYW5nZVwiO1xyXG5pbXBvcnQgeyBDbGFpbSB9IGZyb20gXCIuLi9kYXRhTW9kZWxzL0NsYWltXCI7XHJcbmltcG9ydCB7IElEIH0gZnJvbSBcIi4uL2RhdGFNb2RlbHMvSWRcIjtcclxuaW1wb3J0IHsgQ2xhaW1FZGdlIH0gZnJvbSBcIi4uL2RhdGFNb2RlbHMvQ2xhaW1FZGdlXCI7XHJcbmltcG9ydCB7IFJlcG9zaXRvcnkgfSBmcm9tIFwiLi4vUmVwb3NpdG9yeVwiO1xyXG5pbXBvcnQgeyBBZmZlY3RzIH0gZnJvbSBcIi4uL2RhdGFNb2RlbHMvQWZmZWN0c1wiO1xyXG5cclxuXHJcbnRlc3QoJ2NsYWltIHdpdGhvdXQgYW55IGVkZ2VzIHNob3VsZCBoYXZlIHNjb3JlIG9mIDEnLCAoKSA9PiB7XHJcbiAgICBjb25zdCByZXBvID0gbmV3IFJlcG9zaXRvcnkoKTtcclxuICAgIGNvbnN0IGNhbGNJbml0YXRvciA9IG5ldyBDYWxjdWxhdGlvbkluaXRhdG9yKHJlcG8pO1xyXG4gICAgY29uc3QgY2xhaW0gPSBuZXcgQ2xhaW0oXCJNZWFzdXJlZCBDbGFpbVwiLCBJRChcIjBcIikpO1xyXG4gICAgY2FsY0luaXRhdG9yLm5vdGlmeShbXHJcbiAgICAgICAgbmV3IENoYW5nZShjbGFpbSksXHJcbiAgICBdKTtcclxuICAgIGV4cGVjdChyZXBvLmdldFNjb3JlQnlTb3VyY2VDbGFpbUlkKGNsYWltLmlkKS5zb3VyY2VDbGFpbUlkKS50b0JlKGNsYWltLmlkKTtcclxuICAgIGV4cGVjdChyZXBvLmdldFNjb3JlQnlTb3VyY2VDbGFpbUlkKGNsYWltLmlkKS5jb25maWRlbmNlKS50b0JlKDEpO1xyXG5cclxufSk7XHJcblxyXG50ZXN0KCdjbGFpbSB3aXRoIHR3byBjb24gZGVzY2VuZGFudHMgc2hvdWxkIGhhdmUgYSBjb25maWRlbmNlIG9mIDAnLCAoKSA9PiB7XHJcbiAgICBjb25zdCByZXBvID0gbmV3IFJlcG9zaXRvcnkoKTtcclxuICAgIGNvbnN0IGNhbGNJbml0YXRvciA9IG5ldyBDYWxjdWxhdGlvbkluaXRhdG9yKHJlcG8pO1xyXG4gICAgY29uc3QgbWVhc3VyZWRDbGFpbSA9IG5ldyBDbGFpbShcIk1lYXN1cmVkIENsYWltXCIsIElEKFwibWVhc3VyZWRDbGFpbVwiKSk7XHJcbiAgICBjb25zdCBjaGlsZENsYWltMSA9IG5ldyBDbGFpbShcIkNoaWxkIENsYWltIDFcIiwgSUQoXCJjaGlsZENsYWltMVwiKSk7XHJcbiAgICBjb25zdCBkZXNjZW5kYW50Q2xhaW0gPSBuZXcgQ2xhaW0oXCJEZXNjZW5kYW50IENsYWltXCIsIElEKFwiZGVzY2VuZGFudENsYWltXCIpKTtcclxuICAgIGNhbGNJbml0YXRvci5ub3RpZnkoW1xyXG4gICAgICAgIG5ldyBDaGFuZ2UobWVhc3VyZWRDbGFpbSksXHJcbiAgICAgICAgbmV3IENoYW5nZShjaGlsZENsYWltMSksXHJcbiAgICAgICAgbmV3IENoYW5nZShkZXNjZW5kYW50Q2xhaW0pLFxyXG4gICAgICAgIG5ldyBDaGFuZ2UobmV3IENsYWltRWRnZShtZWFzdXJlZENsYWltLmlkLCBjaGlsZENsYWltMS5pZCwgQWZmZWN0cy5Db25maWRlbmNlLCBmYWxzZSkpLFxyXG4gICAgICAgIG5ldyBDaGFuZ2UobmV3IENsYWltRWRnZShjaGlsZENsYWltMS5pZCwgZGVzY2VuZGFudENsYWltLmlkLCBBZmZlY3RzLkNvbmZpZGVuY2UsIGZhbHNlKSksXHJcbiAgICBdKTtcclxuICAgIGV4cGVjdChyZXBvLmdldFNjb3JlQnlTb3VyY2VDbGFpbUlkKG1lYXN1cmVkQ2xhaW0uaWQpLmNvbmZpZGVuY2UpLnRvQmUoMCk7XHJcbn0pO1xyXG5cclxudGVzdCgnY2xhaW0gd2l0aCB0d28gY29uIGRlc2NlbmRhbnRzIGFuZCBvdGhlciBjaGlsZHJlbiBzaG91bGQgaGF2ZSBhIGNvbmZpZGVuY2Ugb2YgMScsICgpID0+IHtcclxuICAgIGNvbnN0IHJlcG8gPSBuZXcgUmVwb3NpdG9yeSgpO1xyXG4gICAgY29uc3QgY2FsY0luaXRhdG9yID0gbmV3IENhbGN1bGF0aW9uSW5pdGF0b3IocmVwbyk7XHJcbiAgICBjb25zdCBtZWFzdXJlZENsYWltID0gbmV3IENsYWltKFwiTWVhc3VyZWQgQ2xhaW1cIiwgSUQoXCJtZWFzdXJlZENsYWltXCIpKTtcclxuICAgIGNvbnN0IGNoaWxkQ2xhaW0xID0gbmV3IENsYWltKFwiQ2hpbGQgQ2xhaW0gMVwiLCBJRChcImNoaWxkQ2xhaW0xXCIpKTtcclxuICAgIGNvbnN0IGNoaWxkQ2xhaW0yID0gbmV3IENsYWltKFwiQ2hpbGQgQ2xhaW0gMlwiLCBJRChcImNoaWxkQ2xhaW0yXCIpKTtcclxuICAgIGNvbnN0IGRlc2NlbmRhbnRDbGFpbSA9IG5ldyBDbGFpbShcIkRlc2NlbmRhbnQgQ2xhaW1cIiwgSUQoXCJkZXNjZW5kYW50Q2xhaW1cIikpO1xyXG4gICAgY2FsY0luaXRhdG9yLm5vdGlmeShbXHJcbiAgICAgICAgbmV3IENoYW5nZShtZWFzdXJlZENsYWltKSxcclxuICAgICAgICBuZXcgQ2hhbmdlKGNoaWxkQ2xhaW0xKSxcclxuICAgICAgICBuZXcgQ2hhbmdlKGRlc2NlbmRhbnRDbGFpbSksXHJcbiAgICAgICAgbmV3IENoYW5nZShuZXcgQ2xhaW1FZGdlKG1lYXN1cmVkQ2xhaW0uaWQsIGNoaWxkQ2xhaW0xLmlkLCBBZmZlY3RzLkNvbmZpZGVuY2UsIGZhbHNlKSksXHJcbiAgICAgICAgbmV3IENoYW5nZShuZXcgQ2xhaW1FZGdlKG1lYXN1cmVkQ2xhaW0uaWQsIGNoaWxkQ2xhaW0yLmlkLCBBZmZlY3RzLkNvbmZpZGVuY2UsIHRydWUpKSxcclxuICAgICAgICBuZXcgQ2hhbmdlKG5ldyBDbGFpbUVkZ2UoY2hpbGRDbGFpbTEuaWQsIGRlc2NlbmRhbnRDbGFpbS5pZCwgQWZmZWN0cy5Db25maWRlbmNlLCBmYWxzZSkpLFxyXG4gICAgXSk7XHJcbiAgICBleHBlY3QocmVwby5nZXRTY29yZUJ5U291cmNlQ2xhaW1JZChtZWFzdXJlZENsYWltLmlkKS5jb25maWRlbmNlKS50b0JlKDEpO1xyXG59KTtcclxuXHJcbnRlc3QoJ011bHRpcGxlIGNoaWxkcmVuIGNhbGN1bGF0aW9uJywgKCkgPT4ge1xyXG4gICAgY29uc3QgcmVwbyA9IG5ldyBSZXBvc2l0b3J5KCk7XHJcbiAgICBjb25zdCBjYWxjSW5pdGF0b3IgPSBuZXcgQ2FsY3VsYXRpb25Jbml0YXRvcihyZXBvKTtcclxuICAgIGNvbnN0IG1lYXN1cmVkQ2xhaW0gPSBuZXcgQ2xhaW0oXCJNZWFzdXJlZCBDbGFpbVwiLCBJRChcIm1lYXN1cmVkQ2xhaW1cIikpO1xyXG4gICAgY29uc3QgY2hpbGRDbGFpbTEgPSBuZXcgQ2xhaW0oXCJDaGlsZCBDbGFpbSAxXCIsIElEKFwiY2hpbGRDbGFpbTFcIikpO1xyXG4gICAgY29uc3QgY2hpbGRDbGFpbTIgPSBuZXcgQ2xhaW0oXCJDaGlsZCBDbGFpbSAyXCIsIElEKFwiY2hpbGRDbGFpbTJcIikpO1xyXG4gICAgY29uc3QgZGVzY2VuZGFudENsYWltID0gbmV3IENsYWltKFwiRGVzY2VuZGFudCBDbGFpbVwiLCBJRChcImRlc2NlbmRhbnRDbGFpbVwiKSk7XHJcbiAgICBjYWxjSW5pdGF0b3Iubm90aWZ5KFtcclxuICAgICAgICBuZXcgQ2hhbmdlKG1lYXN1cmVkQ2xhaW0pLFxyXG4gICAgICAgIG5ldyBDaGFuZ2UoY2hpbGRDbGFpbTEpLFxyXG4gICAgICAgIG5ldyBDaGFuZ2UoY2hpbGRDbGFpbTIpLFxyXG4gICAgICAgIG5ldyBDaGFuZ2UoZGVzY2VuZGFudENsYWltKSxcclxuICAgICAgICBuZXcgQ2hhbmdlKG5ldyBDbGFpbUVkZ2UobWVhc3VyZWRDbGFpbS5pZCwgY2hpbGRDbGFpbTEuaWQsIEFmZmVjdHMuQ29uZmlkZW5jZSwgZmFsc2UpKSxcclxuICAgICAgICBuZXcgQ2hhbmdlKG5ldyBDbGFpbUVkZ2UobWVhc3VyZWRDbGFpbS5pZCwgY2hpbGRDbGFpbTIuaWQsIEFmZmVjdHMuQ29uZmlkZW5jZSwgZmFsc2UpKSxcclxuICAgICAgICBuZXcgQ2hhbmdlKG5ldyBDbGFpbUVkZ2UoY2hpbGRDbGFpbTEuaWQsIGRlc2NlbmRhbnRDbGFpbS5pZCwgQWZmZWN0cy5Db25maWRlbmNlLCBmYWxzZSkpLFxyXG4gICAgXSk7XHJcbiAgICBleHBlY3QocmVwby5nZXRTY29yZUJ5U291cmNlQ2xhaW1JZChtZWFzdXJlZENsYWltLmlkKS5jb25maWRlbmNlKS50b0JlKDApO1xyXG59KTtcclxuXHJcbnRlc3QoJ0RlZmF1bHQgTm90IFJldmVyc2FibGUnLCAoKSA9PiB7XHJcbiAgICBjb25zdCByZXBvID0gbmV3IFJlcG9zaXRvcnkoKTtcclxuICAgIGNvbnN0IGNhbGNJbml0YXRvciA9IG5ldyBDYWxjdWxhdGlvbkluaXRhdG9yKHJlcG8pO1xyXG4gICAgY29uc3QgbWVhc3VyZWRDbGFpbSA9IG5ldyBDbGFpbShcIk1lYXN1cmVkIENsYWltXCIsIElEKFwibWVhc3VyZWRDbGFpbVwiKSk7XHJcbiAgICBjb25zdCBjaGlsZENsYWltMSA9IG5ldyBDbGFpbShcIkNoaWxkIENsYWltIDFcIiwgSUQoXCJjaGlsZENsYWltMVwiKSk7XHJcbiAgICBjYWxjSW5pdGF0b3Iubm90aWZ5KFtcclxuICAgICAgICBuZXcgQ2hhbmdlKG1lYXN1cmVkQ2xhaW0pLFxyXG4gICAgICAgIG5ldyBDaGFuZ2UoY2hpbGRDbGFpbTEpLFxyXG4gICAgICAgIG5ldyBDaGFuZ2UobmV3IENsYWltRWRnZShtZWFzdXJlZENsYWltLmlkLCBjaGlsZENsYWltMS5pZCwgQWZmZWN0cy5Db25maWRlbmNlLCBmYWxzZSkpLFxyXG4gICAgXSk7XHJcbiAgICBleHBlY3QocmVwby5nZXRTY29yZUJ5U291cmNlQ2xhaW1JZChtZWFzdXJlZENsYWltLmlkKS5jb25maWRlbmNlKS50b0JlKDApO1xyXG59KTtcclxuXHJcbnRlc3QoJ1JldmVyc2FibGUnLCAoKSA9PiB7XHJcbiAgICBjb25zdCByZXBvID0gbmV3IFJlcG9zaXRvcnkoKTtcclxuICAgIGNvbnN0IGNhbGNJbml0YXRvciA9IG5ldyBDYWxjdWxhdGlvbkluaXRhdG9yKHJlcG8pO1xyXG4gICAgY29uc3QgbWVhc3VyZWRDbGFpbSA9IG5ldyBDbGFpbShcIk1lYXN1cmVkIENsYWltXCIsIElEKFwibWVhc3VyZWRDbGFpbVwiKSwgdW5kZWZpbmVkLCB1bmRlZmluZWQsIHVuZGVmaW5lZCwgdHJ1ZSk7XHJcbiAgICBjb25zdCBjaGlsZENsYWltMSA9IG5ldyBDbGFpbShcIkNoaWxkIENsYWltIDFcIiwgSUQoXCJjaGlsZENsYWltMVwiKSk7XHJcbiAgICBjYWxjSW5pdGF0b3Iubm90aWZ5KFtcclxuICAgICAgICBuZXcgQ2hhbmdlKG1lYXN1cmVkQ2xhaW0pLFxyXG4gICAgICAgIG5ldyBDaGFuZ2UoY2hpbGRDbGFpbTEpLFxyXG4gICAgICAgIG5ldyBDaGFuZ2UobmV3IENsYWltRWRnZShtZWFzdXJlZENsYWltLmlkLCBjaGlsZENsYWltMS5pZCwgQWZmZWN0cy5Db25maWRlbmNlLCBmYWxzZSkpLFxyXG4gICAgXSk7XHJcbiAgICBleHBlY3QocmVwby5nZXRTY29yZUJ5U291cmNlQ2xhaW1JZChtZWFzdXJlZENsYWltLmlkKS5jb25maWRlbmNlKS50b0JlKC0xKTtcclxufSk7Il19