"use strict";

var _CalculationInitiator = require("../CalculationInitiator");

var _Change = require("../dataModels/Change");

var _Claim = require("../dataModels/Claim");

var _Id = require("../dataModels/Id");

var _ClaimEdge = require("../dataModels/ClaimEdge");

var _Repository = require("../Repository");

var _Affects = require("../dataModels/Affects");

var _ = require("..");

test('claim without any edges should have score of 1', function () {
  var repo = new _Repository.Repository();
  var calcInitator = new _CalculationInitiator.CalculationInitator(repo);
  var claim = new _Claim.Claim("Measured Claim", (0, _Id.ID)("0"));
  calcInitator.notify([new _Change.Change(claim)]);
  expect(repo.getScoreBySourceClaimId(claim.id).sourceClaimId).toBe(claim.id);
  expect(repo.getScoreBySourceClaimId(claim.id).confidence).toBe(1);
  expect(repo.log.length).toBe(2);
});
test('claim with two con descendants should have a confidence of 0', function () {
  var repo = new _Repository.Repository();
  var calcInitator = new _CalculationInitiator.CalculationInitator(repo);
  var measuredClaim = new _Claim.Claim("Measured Claim", (0, _Id.ID)("measuredClaim"));
  var childClaim1 = new _Claim.Claim("Child Claim 1", (0, _Id.ID)("childClaim1"));
  var descendantClaim = new _Claim.Claim("Descendant Claim", (0, _Id.ID)("descendantClaim"));
  calcInitator.notify([new _Change.Change(measuredClaim), new _Change.Change(childClaim1), new _Change.Change(descendantClaim), new _Change.Change(new _ClaimEdge.ClaimEdge(measuredClaim.id, childClaim1.id, _Affects.Affects.Confidence, false)), new _Change.Change(new _ClaimEdge.ClaimEdge(childClaim1.id, descendantClaim.id, _Affects.Affects.Confidence, false))]);
  expect(repo.getScoreBySourceClaimId(measuredClaim.id).confidence).toBe(0);
});
test('claim with two con descendants and other children should have a confidence of 1', function () {
  var repo = new _Repository.Repository();
  var calcInitator = new _CalculationInitiator.CalculationInitator(repo);
  var measuredClaim = new _Claim.Claim("Measured Claim", (0, _Id.ID)("measuredClaim"));
  var childClaim1 = new _Claim.Claim("Child Claim 1", (0, _Id.ID)("childClaim1"));
  var childClaim2 = new _Claim.Claim("Child Claim 2", (0, _Id.ID)("childClaim2"));
  var descendantClaim = new _Claim.Claim("Descendant Claim", (0, _Id.ID)("descendantClaim"));
  calcInitator.notify([new _Change.Change(measuredClaim), new _Change.Change(childClaim1), new _Change.Change(descendantClaim), new _Change.Change(new _ClaimEdge.ClaimEdge(measuredClaim.id, childClaim1.id, _Affects.Affects.Confidence, false)), new _Change.Change(new _ClaimEdge.ClaimEdge(measuredClaim.id, childClaim2.id, _Affects.Affects.Confidence, true)), new _Change.Change(new _ClaimEdge.ClaimEdge(childClaim1.id, descendantClaim.id, _Affects.Affects.Confidence, false))]);
  expect(repo.getScoreBySourceClaimId(measuredClaim.id).confidence).toBe(1);
});
test('Multiple children calculation', function () {
  var repo = new _Repository.Repository();
  var calcInitator = new _CalculationInitiator.CalculationInitator(repo);
  var measuredClaim = new _Claim.Claim("Measured Claim", (0, _Id.ID)("measuredClaim"));
  var childClaim1 = new _Claim.Claim("Child Claim 1", (0, _Id.ID)("childClaim1"));
  var childClaim2 = new _Claim.Claim("Child Claim 2", (0, _Id.ID)("childClaim2"));
  var descendantClaim = new _Claim.Claim("Descendant Claim", (0, _Id.ID)("descendantClaim"));
  calcInitator.notify([new _Change.Change(measuredClaim), new _Change.Change(childClaim1), new _Change.Change(childClaim2), new _Change.Change(descendantClaim), new _Change.Change(new _ClaimEdge.ClaimEdge(measuredClaim.id, childClaim1.id, _Affects.Affects.Confidence, false)), new _Change.Change(new _ClaimEdge.ClaimEdge(measuredClaim.id, childClaim2.id, _Affects.Affects.Confidence, false)), new _Change.Change(new _ClaimEdge.ClaimEdge(childClaim1.id, descendantClaim.id, _Affects.Affects.Confidence, false))]);
  expect(repo.getScoreBySourceClaimId(measuredClaim.id).confidence).toBe(0);
});
test('Default Not Reversible', function () {
  var repo = new _Repository.Repository();
  var calcInitator = new _CalculationInitiator.CalculationInitator(repo);
  var measuredClaim = new _Claim.Claim("Measured Claim", (0, _Id.ID)("measuredClaim"));
  var childClaim1 = new _Claim.Claim("Child Claim 1", (0, _Id.ID)("childClaim1"));
  calcInitator.notify([new _Change.Change(measuredClaim), new _Change.Change(childClaim1), new _Change.Change(new _ClaimEdge.ClaimEdge(measuredClaim.id, childClaim1.id, _Affects.Affects.Confidence, false))]);
  expect(repo.getScoreBySourceClaimId(measuredClaim.id).confidence).toBe(0);
});
test('Reversible', function () {
  var repo = new _Repository.Repository();
  var calcInitator = new _CalculationInitiator.CalculationInitator(repo);
  var measuredClaim = new _Claim.Claim("Measured Claim", (0, _Id.ID)("measuredClaim"), undefined, undefined, undefined, true);
  var childClaim1 = new _Claim.Claim("Child Claim 1", (0, _Id.ID)("childClaim1"));
  calcInitator.notify([new _Change.Change(measuredClaim), new _Change.Change(childClaim1), new _Change.Change(new _ClaimEdge.ClaimEdge(measuredClaim.id, childClaim1.id, _Affects.Affects.Confidence, false))]);
  expect(repo.getScoreBySourceClaimId(measuredClaim.id).confidence).toBe(-1);
});
test('Weird test case', function () {
  var repo = new _Repository.Repository();
  var messenger = new _.Messenger();
  var calcInitator = new _CalculationInitiator.CalculationInitator(repo, messenger.notify);
  var topClaim = new _Claim.Claim("Fiction City should convert Elm Street to only pedestrian traffic?", (0, _Id.ID)("1"));
  var increaseBusiness = new _Claim.Claim("The planning commission estimates this will increase foot traffic to local shops by 12% during peak hours.", (0, _Id.ID)("2"));
  var increaseTraffic = new _Claim.Claim("This will result in traffic being diverted down residential streets.", (0, _Id.ID)("Traffic"));
  var childSafety = new _Claim.Claim("Children safety is more important than profit for local shops.");
  var newStreet = new _Claim.Claim("A set of railroad tracks are no longer in use and the City can convert that to a new street.");
  var costs = new _Claim.Claim("The conversion will cost 2 Million dollars.");
  var payoff = new _Claim.Claim("The increase in revenue is expected to pay off the expense in under 2 years meeting the cities investment requirements.");
  var testEdgeId = (0, _Id.ID)("TestEdge");
  calcInitator.notify([new _Change.Change(topClaim), new _Change.Change(increaseBusiness), new _Change.Change(new _ClaimEdge.ClaimEdge(topClaim.id, increaseBusiness.id, _Affects.Affects.Confidence, true)), new _Change.Change(increaseTraffic), new _Change.Change(new _ClaimEdge.ClaimEdge(topClaim.id, increaseTraffic.id, _Affects.Affects.Confidence, false, testEdgeId)), new _Change.Change(childSafety), new _Change.Change(new _ClaimEdge.ClaimEdge(increaseTraffic.id, childSafety.id, _Affects.Affects.Relevance, true)), new _Change.Change(newStreet), new _Change.Change(new _ClaimEdge.ClaimEdge(increaseTraffic.id, newStreet.id, _Affects.Affects.Confidence, false)), new _Change.Change(costs), new _Change.Change(new _ClaimEdge.ClaimEdge(topClaim.id, costs.id, _Affects.Affects.Confidence, false)), new _Change.Change(payoff), new _Change.Change(new _ClaimEdge.ClaimEdge(increaseBusiness.id, payoff.id, _Affects.Affects.Relevance, true))]);
  expect(repo.getScoreBySourceClaimId(topClaim.id).confidence).toBe(0.3333333333333333);
  calcInitator.notify([new _Change.Change(increaseTraffic), // Sending in a claim resets it's score to 1 incorrectly
  new _Change.Change(new _ClaimEdge.ClaimEdge(topClaim.id, increaseTraffic.id, _Affects.Affects.Confidence, true, testEdgeId))]);
  expect(repo.getScoreBySourceClaimId(topClaim.id).confidence).toBe(0.3333333333333333);
  calcInitator.notify([new _Change.Change(new _ClaimEdge.ClaimEdge(topClaim.id, increaseTraffic.id, _Affects.Affects.Confidence, false, testEdgeId))]);
  expect(repo.getScoreBySourceClaimId(topClaim.id).confidence).toBe(0.3333333333333333);
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy90ZXN0cy9DYWxjdWxhdGlvbkluaXRpYXRvci50ZXN0LnRzIl0sIm5hbWVzIjpbInRlc3QiLCJyZXBvIiwiUmVwb3NpdG9yeSIsImNhbGNJbml0YXRvciIsIkNhbGN1bGF0aW9uSW5pdGF0b3IiLCJjbGFpbSIsIkNsYWltIiwibm90aWZ5IiwiQ2hhbmdlIiwiZXhwZWN0IiwiZ2V0U2NvcmVCeVNvdXJjZUNsYWltSWQiLCJpZCIsInNvdXJjZUNsYWltSWQiLCJ0b0JlIiwiY29uZmlkZW5jZSIsImxvZyIsImxlbmd0aCIsIm1lYXN1cmVkQ2xhaW0iLCJjaGlsZENsYWltMSIsImRlc2NlbmRhbnRDbGFpbSIsIkNsYWltRWRnZSIsIkFmZmVjdHMiLCJDb25maWRlbmNlIiwiY2hpbGRDbGFpbTIiLCJ1bmRlZmluZWQiLCJtZXNzZW5nZXIiLCJNZXNzZW5nZXIiLCJ0b3BDbGFpbSIsImluY3JlYXNlQnVzaW5lc3MiLCJpbmNyZWFzZVRyYWZmaWMiLCJjaGlsZFNhZmV0eSIsIm5ld1N0cmVldCIsImNvc3RzIiwicGF5b2ZmIiwidGVzdEVkZ2VJZCIsIlJlbGV2YW5jZSJdLCJtYXBwaW5ncyI6Ijs7QUFBQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFHQUEsSUFBSSxDQUFDLGdEQUFELEVBQW1ELFlBQU07QUFDekQsTUFBTUMsSUFBSSxHQUFHLElBQUlDLHNCQUFKLEVBQWI7QUFDQSxNQUFNQyxZQUFZLEdBQUcsSUFBSUMseUNBQUosQ0FBd0JILElBQXhCLENBQXJCO0FBQ0EsTUFBTUksS0FBSyxHQUFHLElBQUlDLFlBQUosQ0FBVSxnQkFBVixFQUE0QixZQUFHLEdBQUgsQ0FBNUIsQ0FBZDtBQUNBSCxFQUFBQSxZQUFZLENBQUNJLE1BQWIsQ0FBb0IsQ0FDaEIsSUFBSUMsY0FBSixDQUFXSCxLQUFYLENBRGdCLENBQXBCO0FBR0FJLEVBQUFBLE1BQU0sQ0FBQ1IsSUFBSSxDQUFDUyx1QkFBTCxDQUE2QkwsS0FB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SSxDQUFDUyx1QkFBTCxDQUE2QmlCLFFBQVEsQ0FBQ2hCLEVBQXRDLEVBQTBDRyxVQUEzQyxDQUFOLENBQTZERCxJQUE3RCxDQUFrRSxrQkFBbEU7QUFFQVYsRUFBQUEsWUFBWSxDQUFDSSxNQUFiLENBQW9CLENBQ2hCLElBQUlDLGNBQUosQ0FBV3FCLGVBQVgsQ0FEZ0IsRUFDWTtBQUM1QixNQUFJckIsY0FBSixDQUFXLElBQUlZLG9CQUFKLENBQWNPLFFBQVEsQ0FBQ2hCLEVBQXZCLEVBQTJCa0IsZUFBZSxDQUFDbEIsRUFBM0MsRUFBK0NVLGlCQUFRQyxVQUF2RCxFQUFtRSxJQUFuRSxFQUF5RVksVUFBekUsQ0FBWCxDQUZnQixDQUFwQjtBQUlBekIsRUFBQUEsTUFBTSxDQUFDUixJQUFJLENBQUNTLHVCQUFMLENBQTZCaUIsUUFBUSxDQUFDaEIsRUFBdEMsRUFBMENHLFVBQTNDLENBQU4sQ0FBNkRELElBQTdELENBQWtFLGtCQUFsRTtBQUVBVixFQUFBQSxZQUFZLENBQUNJLE1BQWIsQ0FBb0IsQ0FDaEIsSUFBSUMsY0FBSixDQUFXLElBQUlZLG9CQUFKLENBQWNPLFFBQVEsQ0FBQ2hCLEVBQXZCLEVBQTJCa0IsZUFBZSxDQUFDbEIsRUFBM0MsRUFBK0NVLGlCQUFRQyxVQUF2RCxFQUFtRSxLQUFuRSxFQUEwRVksVUFBMUUsQ0FBWCxDQURnQixDQUFwQjtBQUdBekIsRUFBQUEsTUFBTSxDQUFDUixJQUFJLENBQUNTLHVCQUFMLENBQTZCaUIsUUFBUSxDQUFDaEIsRUFBdEMsRUFBMENHLFVBQTNDLENBQU4sQ0FBNkRELElBQTdELENBQWtFLGtCQUFsRTtBQUVILENBMUNHLENBQUoiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDYWxjdWxhdGlvbkluaXRhdG9yIH0gZnJvbSBcIi4uL0NhbGN1bGF0aW9uSW5pdGlhdG9yXCI7XHJcbmltcG9ydCB7IENoYW5nZSB9IGZyb20gXCIuLi9kYXRhTW9kZWxzL0NoYW5nZVwiO1xyXG5pbXBvcnQgeyBDbGFpbSB9IGZyb20gXCIuLi9kYXRhTW9kZWxzL0NsYWltXCI7XHJcbmltcG9ydCB7IElEIH0gZnJvbSBcIi4uL2RhdGFNb2RlbHMvSWRcIjtcclxuaW1wb3J0IHsgQ2xhaW1FZGdlIH0gZnJvbSBcIi4uL2RhdGFNb2RlbHMvQ2xhaW1FZGdlXCI7XHJcbmltcG9ydCB7IFJlcG9zaXRvcnkgfSBmcm9tIFwiLi4vUmVwb3NpdG9yeVwiO1xyXG5pbXBvcnQgeyBBZmZlY3RzIH0gZnJvbSBcIi4uL2RhdGFNb2RlbHMvQWZmZWN0c1wiO1xyXG5pbXBvcnQgeyBuZXdJZCwgTWVzc2VuZ2VyIH0gZnJvbSBcIi4uXCI7XHJcblxyXG5cclxudGVzdCgnY2xhaW0gd2l0aG91dCBhbnkgZWRnZXMgc2hvdWxkIGhhdmUgc2NvcmUgb2YgMScsICgpID0+IHtcclxuICAgIGNvbnN0IHJlcG8gPSBuZXcgUmVwb3NpdG9yeSgpO1xyXG4gICAgY29uc3QgY2FsY0luaXRhdG9yID0gbmV3IENhbGN1bGF0aW9uSW5pdGF0b3IocmVwbyk7XHJcbiAgICBjb25zdCBjbGFpbSA9IG5ldyBDbGFpbShcIk1lYXN1cmVkIENsYWltXCIsIElEKFwiMFwiKSk7XHJcbiAgICBjYWxjSW5pdGF0b3Iubm90aWZ5KFtcclxuICAgICAgICBuZXcgQ2hhbmdlKGNsYWltKSxcclxuICAgIF0pO1xyXG4gICAgZXhwZWN0KHJlcG8uZ2V0U2NvcmVCeVNvdXJjZUNsYWltSWQoY2xhaW0uaWQpLnNvdXJjZUNsYWltSWQpLnRvQmUoY2xhaW0uaWQpO1xyXG4gICAgZXhwZWN0KHJlcG8uZ2V0U2NvcmVCeVNvdXJjZUNsYWltSWQoY2xhaW0uaWQpLmNvbmZpZGVuY2UpLnRvQmUoMSk7XHJcbiAgICBleHBlY3QocmVwby5sb2cubGVuZ3RoKS50b0JlKDIpO1xyXG5cclxufSk7XHJcblxyXG50ZXN0KCdjbGFpbSB3aXRoIHR3byBjb24gZGVzY2VuZGFudHMgc2hvdWxkIGhhdmUgYSBjb25maWRlbmNlIG9mIDAnLCAoKSA9PiB7XHJcbiAgICBjb25zdCByZXBvID0gbmV3IFJlcG9zaXRvcnkoKTtcclxuICAgIGNvbnN0IGNhbGNJbml0YXRvciA9IG5ldyBDYWxjdWxhdGlvbkluaXRhdG9yKHJlcG8pO1xyXG4gICAgY29uc3QgbWVhc3VyZWRDbGFpbSA9IG5ldyBDbGFpbShcIk1lYXN1cmVkIENsYWltXCIsIElEKFwibWVhc3VyZWRDbGFpbVwiKSk7XHJcbiAgICBjb25zdCBjaGlsZENsYWltMSA9IG5ldyBDbGFpbShcIkNoaWxkIENsYWltIDFcIiwgSUQoXCJjaGlsZENsYWltMVwiKSk7XHJcbiAgICBjb25zdCBkZXNjZW5kYW50Q2xhaW0gPSBuZXcgQ2xhaW0oXCJEZXNjZW5kYW50IENsYWltXCIsIElEKFwiZGVzY2VuZGFudENsYWltXCIpKTtcclxuICAgIGNhbGNJbml0YXRvci5ub3RpZnkoW1xyXG4gICAgICAgIG5ldyBDaGFuZ2UobWVhc3VyZWRDbGFpbSksXHJcbiAgICAgICAgbmV3IENoYW5nZShjaGlsZENsYWltMSksXHJcbiAgICAgICAgbmV3IENoYW5nZShkZXNjZW5kYW50Q2xhaW0pLFxyXG4gICAgICAgIG5ldyBDaGFuZ2UobmV3IENsYWltRWRnZShtZWFzdXJlZENsYWltLmlkLCBjaGlsZENsYWltMS5pZCwgQWZmZWN0cy5Db25maWRlbmNlLCBmYWxzZSkpLFxyXG4gICAgICAgIG5ldyBDaGFuZ2UobmV3IENsYWltRWRnZShjaGlsZENsYWltMS5pZCwgZGVzY2VuZGFudENsYWltLmlkLCBBZmZlY3RzLkNvbmZpZGVuY2UsIGZhbHNlKSksXHJcbiAgICBdKTtcclxuICAgIGV4cGVjdChyZXBvLmdldFNjb3JlQnlTb3VyY2VDbGFpbUlkKG1lYXN1cmVkQ2xhaW0uaWQpLmNvbmZpZGVuY2UpLnRvQmUoMCk7XHJcbn0pO1xyXG5cclxudGVzdCgnY2xhaW0gd2l0aCB0d28gY29uIGRlc2NlbmRhbnRzIGFuZCBvdGhlciBjaGlsZHJlbiBzaG91bGQgaGF2ZSBhIGNvbmZpZGVuY2Ugb2YgMScsICgpID0+IHtcclxuICAgIGNvbnN0IHJlcG8gPSBuZXcgUmVwb3NpdG9yeSgpO1xyXG4gICAgY29uc3QgY2FsY0luaXRhdG9yID0gbmV3IENhbGN1bGF0aW9uSW5pdGF0b3IocmVwbyk7XHJcbiAgICBjb25zdCBtZWFzdXJlZENsYWltID0gbmV3IENsYWltKFwiTWVhc3VyZWQgQ2xhaW1cIiwgSUQoXCJtZWFzdXJlZENsYWltXCIpKTtcclxuICAgIGNvbnN0IGNoaWxkQ2xhaW0xID0gbmV3IENsYWltKFwiQ2hpbGQgQ2xhaW0gMVwiLCBJRChcImNoaWxkQ2xhaW0xXCIpKTtcclxuICAgIGNvbnN0IGNoaWxkQ2xhaW0yID0gbmV3IENsYWltKFwiQ2hpbGQgQ2xhaW0gMlwiLCBJRChcImNoaWxkQ2xhaW0yXCIpKTtcclxuICAgIGNvbnN0IGRlc2NlbmRhbnRDbGFpbSA9IG5ldyBDbGFpbShcIkRlc2NlbmRhbnQgQ2xhaW1cIiwgSUQoXCJkZXNjZW5kYW50Q2xhaW1cIikpO1xyXG4gICAgY2FsY0luaXRhdG9yLm5vdGlmeShbXHJcbiAgICAgICAgbmV3IENoYW5nZShtZWFzdXJlZENsYWltKSxcclxuICAgICAgICBuZXcgQ2hhbmdlKGNoaWxkQ2xhaW0xKSxcclxuICAgICAgICBuZXcgQ2hhbmdlKGRlc2NlbmRhbnRDbGFpbSksXHJcbiAgICAgICAgbmV3IENoYW5nZShuZXcgQ2xhaW1FZGdlKG1lYXN1cmVkQ2xhaW0uaWQsIGNoaWxkQ2xhaW0xLmlkLCBBZmZlY3RzLkNvbmZpZGVuY2UsIGZhbHNlKSksXHJcbiAgICAgICAgbmV3IENoYW5nZShuZXcgQ2xhaW1FZGdlKG1lYXN1cmVkQ2xhaW0uaWQsIGNoaWxkQ2xhaW0yLmlkLCBBZmZlY3RzLkNvbmZpZGVuY2UsIHRydWUpKSxcclxuICAgICAgICBuZXcgQ2hhbmdlKG5ldyBDbGFpbUVkZ2UoY2hpbGRDbGFpbTEuaWQsIGRlc2NlbmRhbnRDbGFpbS5pZCwgQWZmZWN0cy5Db25maWRlbmNlLCBmYWxzZSkpLFxyXG4gICAgXSk7XHJcbiAgICBleHBlY3QocmVwby5nZXRTY29yZUJ5U291cmNlQ2xhaW1JZChtZWFzdXJlZENsYWltLmlkKS5jb25maWRlbmNlKS50b0JlKDEpO1xyXG59KTtcclxuXHJcbnRlc3QoJ011bHRpcGxlIGNoaWxkcmVuIGNhbGN1bGF0aW9uJywgKCkgPT4ge1xyXG4gICAgY29uc3QgcmVwbyA9IG5ldyBSZXBvc2l0b3J5KCk7XHJcbiAgICBjb25zdCBjYWxjSW5pdGF0b3IgPSBuZXcgQ2FsY3VsYXRpb25Jbml0YXRvcihyZXBvKTtcclxuICAgIGNvbnN0IG1lYXN1cmVkQ2xhaW0gPSBuZXcgQ2xhaW0oXCJNZWFzdXJlZCBDbGFpbVwiLCBJRChcIm1lYXN1cmVkQ2xhaW1cIikpO1xyXG4gICAgY29uc3QgY2hpbGRDbGFpbTEgPSBuZXcgQ2xhaW0oXCJDaGlsZCBDbGFpbSAxXCIsIElEKFwiY2hpbGRDbGFpbTFcIikpO1xyXG4gICAgY29uc3QgY2hpbGRDbGFpbTIgPSBuZXcgQ2xhaW0oXCJDaGlsZCBDbGFpbSAyXCIsIElEKFwiY2hpbGRDbGFpbTJcIikpO1xyXG4gICAgY29uc3QgZGVzY2VuZGFudENsYWltID0gbmV3IENsYWltKFwiRGVzY2VuZGFudCBDbGFpbVwiLCBJRChcImRlc2NlbmRhbnRDbGFpbVwiKSk7XHJcbiAgICBjYWxjSW5pdGF0b3Iubm90aWZ5KFtcclxuICAgICAgICBuZXcgQ2hhbmdlKG1lYXN1cmVkQ2xhaW0pLFxyXG4gICAgICAgIG5ldyBDaGFuZ2UoY2hpbGRDbGFpbTEpLFxyXG4gICAgICAgIG5ldyBDaGFuZ2UoY2hpbGRDbGFpbTIpLFxyXG4gICAgICAgIG5ldyBDaGFuZ2UoZGVzY2VuZGFudENsYWltKSxcclxuICAgICAgICBuZXcgQ2hhbmdlKG5ldyBDbGFpbUVkZ2UobWVhc3VyZWRDbGFpbS5pZCwgY2hpbGRDbGFpbTEuaWQsIEFmZmVjdHMuQ29uZmlkZW5jZSwgZmFsc2UpKSxcclxuICAgICAgICBuZXcgQ2hhbmdlKG5ldyBDbGFpbUVkZ2UobWVhc3VyZWRDbGFpbS5pZCwgY2hpbGRDbGFpbTIuaWQsIEFmZmVjdHMuQ29uZmlkZW5jZSwgZmFsc2UpKSxcclxuICAgICAgICBuZXcgQ2hhbmdlKG5ldyBDbGFpbUVkZ2UoY2hpbGRDbGFpbTEuaWQsIGRlc2NlbmRhbnRDbGFpbS5pZCwgQWZmZWN0cy5Db25maWRlbmNlLCBmYWxzZSkpLFxyXG4gICAgXSk7XHJcbiAgICBleHBlY3QocmVwby5nZXRTY29yZUJ5U291cmNlQ2xhaW1JZChtZWFzdXJlZENsYWltLmlkKS5jb25maWRlbmNlKS50b0JlKDApO1xyXG59KTtcclxuXHJcbnRlc3QoJ0RlZmF1bHQgTm90IFJldmVyc2libGUnLCAoKSA9PiB7XHJcbiAgICBjb25zdCByZXBvID0gbmV3IFJlcG9zaXRvcnkoKTtcclxuICAgIGNvbnN0IGNhbGNJbml0YXRvciA9IG5ldyBDYWxjdWxhdGlvbkluaXRhdG9yKHJlcG8pO1xyXG4gICAgY29uc3QgbWVhc3VyZWRDbGFpbSA9IG5ldyBDbGFpbShcIk1lYXN1cmVkIENsYWltXCIsIElEKFwibWVhc3VyZWRDbGFpbVwiKSk7XHJcbiAgICBjb25zdCBjaGlsZENsYWltMSA9IG5ldyBDbGFpbShcIkNoaWxkIENsYWltIDFcIiwgSUQoXCJjaGlsZENsYWltMVwiKSk7XHJcbiAgICBjYWxjSW5pdGF0b3Iubm90aWZ5KFtcclxuICAgICAgICBuZXcgQ2hhbmdlKG1lYXN1cmVkQ2xhaW0pLFxyXG4gICAgICAgIG5ldyBDaGFuZ2UoY2hpbGRDbGFpbTEpLFxyXG4gICAgICAgIG5ldyBDaGFuZ2UobmV3IENsYWltRWRnZShtZWFzdXJlZENsYWltLmlkLCBjaGlsZENsYWltMS5pZCwgQWZmZWN0cy5Db25maWRlbmNlLCBmYWxzZSkpLFxyXG4gICAgXSk7XHJcbiAgICBleHBlY3QocmVwby5nZXRTY29yZUJ5U291cmNlQ2xhaW1JZChtZWFzdXJlZENsYWltLmlkKS5jb25maWRlbmNlKS50b0JlKDApO1xyXG59KTtcclxuXHJcbnRlc3QoJ1JldmVyc2libGUnLCAoKSA9PiB7XHJcbiAgICBjb25zdCByZXBvID0gbmV3IFJlcG9zaXRvcnkoKTtcclxuICAgIGNvbnN0IGNhbGNJbml0YXRvciA9IG5ldyBDYWxjdWxhdGlvbkluaXRhdG9yKHJlcG8pO1xyXG4gICAgY29uc3QgbWVhc3VyZWRDbGFpbSA9IG5ldyBDbGFpbShcIk1lYXN1cmVkIENsYWltXCIsIElEKFwibWVhc3VyZWRDbGFpbVwiKSwgdW5kZWZpbmVkLCB1bmRlZmluZWQsIHVuZGVmaW5lZCwgdHJ1ZSk7XHJcbiAgICBjb25zdCBjaGlsZENsYWltMSA9IG5ldyBDbGFpbShcIkNoaWxkIENsYWltIDFcIiwgSUQoXCJjaGlsZENsYWltMVwiKSk7XHJcbiAgICBjYWxjSW5pdGF0b3Iubm90aWZ5KFtcclxuICAgICAgICBuZXcgQ2hhbmdlKG1lYXN1cmVkQ2xhaW0pLFxyXG4gICAgICAgIG5ldyBDaGFuZ2UoY2hpbGRDbGFpbTEpLFxyXG4gICAgICAgIG5ldyBDaGFuZ2UobmV3IENsYWltRWRnZShtZWFzdXJlZENsYWltLmlkLCBjaGlsZENsYWltMS5pZCwgQWZmZWN0cy5Db25maWRlbmNlLCBmYWxzZSkpLFxyXG4gICAgXSk7XHJcbiAgICBleHBlY3QocmVwby5nZXRTY29yZUJ5U291cmNlQ2xhaW1JZChtZWFzdXJlZENsYWltLmlkKS5jb25maWRlbmNlKS50b0JlKC0xKTtcclxufSk7XHJcblxyXG50ZXN0KCdXZWlyZCB0ZXN0IGNhc2UnLCAoKSA9PiB7XHJcbiAgICBjb25zdCByZXBvID0gbmV3IFJlcG9zaXRvcnkoKTtcclxuICAgIGNvbnN0IG1lc3NlbmdlciA9IG5ldyBNZXNzZW5nZXIoKTtcclxuICAgIGNvbnN0IGNhbGNJbml0YXRvciA9IG5ldyBDYWxjdWxhdGlvbkluaXRhdG9yKHJlcG8sIG1lc3Nlbmdlci5ub3RpZnkpO1xyXG4gICAgY29uc3QgdG9wQ2xhaW0gPSBuZXcgQ2xhaW0oXCJGaWN0aW9uIENpdHkgc2hvdWxkIGNvbnZlcnQgRWxtIFN0cmVldCB0byBvbmx5IHBlZGVzdHJpYW4gdHJhZmZpYz9cIiwgSUQoXCIxXCIpKTtcclxuICAgIGNvbnN0IGluY3JlYXNlQnVzaW5lc3MgPSBuZXcgQ2xhaW0oXCJUaGUgcGxhbm5pbmcgY29tbWlzc2lvbiBlc3RpbWF0ZXMgdGhpcyB3aWxsIGluY3JlYXNlIGZvb3QgdHJhZmZpYyB0byBsb2NhbCBzaG9wcyBieSAxMiUgZHVyaW5nIHBlYWsgaG91cnMuXCIsIElEKFwiMlwiKSk7XHJcbiAgICBjb25zdCBpbmNyZWFzZVRyYWZmaWMgPSBuZXcgQ2xhaW0oXCJUaGlzIHdpbGwgcmVzdWx0IGluIHRyYWZmaWMgYmVpbmcgZGl2ZXJ0ZWQgZG93biByZXNpZGVudGlhbCBzdHJlZXRzLlwiLCBJRChcIlRyYWZmaWNcIikpO1xyXG4gICAgY29uc3QgY2hpbGRTYWZldHkgPSBuZXcgQ2xhaW0oXCJDaGlsZHJlbiBzYWZldHkgaXMgbW9yZSBpbXBvcnRhbnQgdGhhbiBwcm9maXQgZm9yIGxvY2FsIHNob3BzLlwiKTtcclxuICAgIGNvbnN0IG5ld1N0cmVldCA9IG5ldyBDbGFpbShcIkEgc2V0IG9mIHJhaWxyb2FkIHRyYWNrcyBhcmUgbm8gbG9uZ2VyIGluIHVzZSBhbmQgdGhlIENpdHkgY2FuIGNvbnZlcnQgdGhhdCB0byBhIG5ldyBzdHJlZXQuXCIpO1xyXG4gICAgY29uc3QgY29zdHMgPSBuZXcgQ2xhaW0oXCJUaGUgY29udmVyc2lvbiB3aWxsIGNvc3QgMiBNaWxsaW9uIGRvbGxhcnMuXCIpO1xyXG4gICAgY29uc3QgcGF5b2ZmID0gbmV3IENsYWltKFwiVGhlIGluY3JlYXNlIGluIHJldmVudWUgaXMgZXhwZWN0ZWQgdG8gcGF5IG9mZiB0aGUgZXhwZW5zZSBpbiB1bmRlciAyIHllYXJzIG1lZXRpbmcgdGhlIGNpdGllcyBpbnZlc3RtZW50IHJlcXVpcmVtZW50cy5cIik7XHJcblxyXG4gICAgY29uc3QgdGVzdEVkZ2VJZCA9IElEKFwiVGVzdEVkZ2VcIilcclxuXHJcbiAgICBjYWxjSW5pdGF0b3Iubm90aWZ5KFtcclxuICAgICAgICBuZXcgQ2hhbmdlKHRvcENsYWltKSxcclxuICAgICAgICBuZXcgQ2hhbmdlKGluY3JlYXNlQnVzaW5lc3MpLFxyXG4gICAgICAgIG5ldyBDaGFuZ2UobmV3IENsYWltRWRnZSh0b3BDbGFpbS5pZCwgaW5jcmVhc2VCdXNpbmVzcy5pZCwgQWZmZWN0cy5Db25maWRlbmNlLCB0cnVlKSksXHJcbiAgICAgICAgbmV3IENoYW5nZShpbmNyZWFzZVRyYWZmaWMpLFxyXG4gICAgICAgIG5ldyBDaGFuZ2UobmV3IENsYWltRWRnZSh0b3BDbGFpbS5pZCwgaW5jcmVhc2VUcmFmZmljLmlkLCBBZmZlY3RzLkNvbmZpZGVuY2UsIGZhbHNlLCB0ZXN0RWRnZUlkKSksXHJcbiAgICAgICAgbmV3IENoYW5nZShjaGlsZFNhZmV0eSksXHJcbiAgICAgICAgbmV3IENoYW5nZShuZXcgQ2xhaW1FZGdlKGluY3JlYXNlVHJhZmZpYy5pZCwgY2hpbGRTYWZldHkuaWQsIEFmZmVjdHMuUmVsZXZhbmNlLCB0cnVlKSksXHJcbiAgICAgICAgbmV3IENoYW5nZShuZXdTdHJlZXQpLFxyXG4gICAgICAgIG5ldyBDaGFuZ2UobmV3IENsYWltRWRnZShpbmNyZWFzZVRyYWZmaWMuaWQsIG5ld1N0cmVldC5pZCwgQWZmZWN0cy5Db25maWRlbmNlLCBmYWxzZSkpLFxyXG4gICAgICAgIG5ldyBDaGFuZ2UoY29zdHMpLFxyXG4gICAgICAgIG5ldyBDaGFuZ2UobmV3IENsYWltRWRnZSh0b3BDbGFpbS5pZCwgY29zdHMuaWQsIEFmZmVjdHMuQ29uZmlkZW5jZSwgZmFsc2UpKSxcclxuICAgICAgICBuZXcgQ2hhbmdlKHBheW9mZiksXHJcbiAgICAgICAgbmV3IENoYW5nZShuZXcgQ2xhaW1FZGdlKGluY3JlYXNlQnVzaW5lc3MuaWQsIHBheW9mZi5pZCwgQWZmZWN0cy5SZWxldmFuY2UsIHRydWUpKSxcclxuICAgIF0pO1xyXG4gICAgZXhwZWN0KHJlcG8uZ2V0U2NvcmVCeVNvdXJjZUNsYWltSWQodG9wQ2xhaW0uaWQpLmNvbmZpZGVuY2UpLnRvQmUoMC4zMzMzMzMzMzMzMzMzMzMzKTtcclxuXHJcbiAgICBjYWxjSW5pdGF0b3Iubm90aWZ5KFtcclxuICAgICAgICBuZXcgQ2hhbmdlKGluY3JlYXNlVHJhZmZpYyksLy8gU2VuZGluZyBpbiBhIGNsYWltIHJlc2V0cyBpdCdzIHNjb3JlIHRvIDEgaW5jb3JyZWN0bHlcclxuICAgICAgICBuZXcgQ2hhbmdlKG5ldyBDbGFpbUVkZ2UodG9wQ2xhaW0uaWQsIGluY3JlYXNlVHJhZmZpYy5pZCwgQWZmZWN0cy5Db25maWRlbmNlLCB0cnVlLCB0ZXN0RWRnZUlkKSksXHJcbiAgICBdKTtcclxuICAgIGV4cGVjdChyZXBvLmdldFNjb3JlQnlTb3VyY2VDbGFpbUlkKHRvcENsYWltLmlkKS5jb25maWRlbmNlKS50b0JlKDAuMzMzMzMzMzMzMzMzMzMzMyk7XHJcblxyXG4gICAgY2FsY0luaXRhdG9yLm5vdGlmeShbXHJcbiAgICAgICAgbmV3IENoYW5nZShuZXcgQ2xhaW1FZGdlKHRvcENsYWltLmlkLCBpbmNyZWFzZVRyYWZmaWMuaWQsIEFmZmVjdHMuQ29uZmlkZW5jZSwgZmFsc2UsIHRlc3RFZGdlSWQpKSxcclxuICAgIF0pO1xyXG4gICAgZXhwZWN0KHJlcG8uZ2V0U2NvcmVCeVNvdXJjZUNsYWltSWQodG9wQ2xhaW0uaWQpLmNvbmZpZGVuY2UpLnRvQmUoMC4zMzMzMzMzMzMzMzMzMzMzKTtcclxuXHJcbn0pOyJdfQ==