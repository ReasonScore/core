"use strict";

var _CalculationInitiator = require("../CalculationInitiator");

var _Change = require("../dataModels/Change");

var _Claim = require("../dataModels/Claim");

var _Id = require("../dataModels/Id");

var _ClaimEdge = require("../dataModels/ClaimEdge");

var _Repository = require("../Repository");

var _Affects = require("../dataModels/Affects");

var _ = require("..");

test('claim without any edges should have score of 1', function () {
  var repo = new _Repository.Repository();
  var calcInitator = new _CalculationInitiator.CalculationInitator(repo);
  var claim = new _Claim.Claim("Measured Claim", (0, _Id.ID)("0"));
  calcInitator.notify([new _Change.Change(claim)]);
  expect(repo.getScoreBySourceClaimId(claim.id).sourceClaimId).toBe(claim.id);
  expect(repo.getScoreBySourceClaimId(claim.id).confidence).toBe(1);
});
test('claim with two con descendants should have a confidence of 0', function () {
  var repo = new _Repository.Repository();
  var calcInitator = new _CalculationInitiator.CalculationInitator(repo);
  var measuredClaim = new _Claim.Claim("Measured Claim", (0, _Id.ID)("measuredClaim"));
  var childClaim1 = new _Claim.Claim("Child Claim 1", (0, _Id.ID)("childClaim1"));
  var descendantClaim = new _Claim.Claim("Descendant Claim", (0, _Id.ID)("descendantClaim"));
  calcInitator.notify([new _Change.Change(measuredClaim), new _Change.Change(childClaim1), new _Change.Change(descendantClaim), new _Change.Change(new _ClaimEdge.ClaimEdge(measuredClaim.id, childClaim1.id, _Affects.Affects.Confidence, false)), new _Change.Change(new _ClaimEdge.ClaimEdge(childClaim1.id, descendantClaim.id, _Affects.Affects.Confidence, false))]);
  expect(repo.getScoreBySourceClaimId(measuredClaim.id).confidence).toBe(0);
});
test('claim with two con descendants and other children should have a confidence of 1', function () {
  var repo = new _Repository.Repository();
  var calcInitator = new _CalculationInitiator.CalculationInitator(repo);
  var measuredClaim = new _Claim.Claim("Measured Claim", (0, _Id.ID)("measuredClaim"));
  var childClaim1 = new _Claim.Claim("Child Claim 1", (0, _Id.ID)("childClaim1"));
  var childClaim2 = new _Claim.Claim("Child Claim 2", (0, _Id.ID)("childClaim2"));
  var descendantClaim = new _Claim.Claim("Descendant Claim", (0, _Id.ID)("descendantClaim"));
  calcInitator.notify([new _Change.Change(measuredClaim), new _Change.Change(childClaim1), new _Change.Change(descendantClaim), new _Change.Change(new _ClaimEdge.ClaimEdge(measuredClaim.id, childClaim1.id, _Affects.Affects.Confidence, false)), new _Change.Change(new _ClaimEdge.ClaimEdge(measuredClaim.id, childClaim2.id, _Affects.Affects.Confidence, true)), new _Change.Change(new _ClaimEdge.ClaimEdge(childClaim1.id, descendantClaim.id, _Affects.Affects.Confidence, false))]);
  expect(repo.getScoreBySourceClaimId(measuredClaim.id).confidence).toBe(1);
});
test('Multiple children calculation', function () {
  var repo = new _Repository.Repository();
  var calcInitator = new _CalculationInitiator.CalculationInitator(repo);
  var measuredClaim = new _Claim.Claim("Measured Claim", (0, _Id.ID)("measuredClaim"));
  var childClaim1 = new _Claim.Claim("Child Claim 1", (0, _Id.ID)("childClaim1"));
  var childClaim2 = new _Claim.Claim("Child Claim 2", (0, _Id.ID)("childClaim2"));
  var descendantClaim = new _Claim.Claim("Descendant Claim", (0, _Id.ID)("descendantClaim"));
  calcInitator.notify([new _Change.Change(measuredClaim), new _Change.Change(childClaim1), new _Change.Change(childClaim2), new _Change.Change(descendantClaim), new _Change.Change(new _ClaimEdge.ClaimEdge(measuredClaim.id, childClaim1.id, _Affects.Affects.Confidence, false)), new _Change.Change(new _ClaimEdge.ClaimEdge(measuredClaim.id, childClaim2.id, _Affects.Affects.Confidence, false)), new _Change.Change(new _ClaimEdge.ClaimEdge(childClaim1.id, descendantClaim.id, _Affects.Affects.Confidence, false))]);
  expect(repo.getScoreBySourceClaimId(measuredClaim.id).confidence).toBe(0);
});
test('Default Not Reversable', function () {
  var repo = new _Repository.Repository();
  var calcInitator = new _CalculationInitiator.CalculationInitator(repo);
  var measuredClaim = new _Claim.Claim("Measured Claim", (0, _Id.ID)("measuredClaim"));
  var childClaim1 = new _Claim.Claim("Child Claim 1", (0, _Id.ID)("childClaim1"));
  calcInitator.notify([new _Change.Change(measuredClaim), new _Change.Change(childClaim1), new _Change.Change(new _ClaimEdge.ClaimEdge(measuredClaim.id, childClaim1.id, _Affects.Affects.Confidence, false))]);
  expect(repo.getScoreBySourceClaimId(measuredClaim.id).confidence).toBe(0);
});
test('Reversable', function () {
  var repo = new _Repository.Repository();
  var calcInitator = new _CalculationInitiator.CalculationInitator(repo);
  var measuredClaim = new _Claim.Claim("Measured Claim", (0, _Id.ID)("measuredClaim"), undefined, undefined, undefined, true);
  var childClaim1 = new _Claim.Claim("Child Claim 1", (0, _Id.ID)("childClaim1"));
  calcInitator.notify([new _Change.Change(measuredClaim), new _Change.Change(childClaim1), new _Change.Change(new _ClaimEdge.ClaimEdge(measuredClaim.id, childClaim1.id, _Affects.Affects.Confidence, false))]);
  expect(repo.getScoreBySourceClaimId(measuredClaim.id).confidence).toBe(-1);
});
test('Weird test case', function () {
  var repo = new _Repository.Repository();
  var messenger = new _.Messenger();
  var calcInitator = new _CalculationInitiator.CalculationInitator(repo, messenger.notify);
  var topClaim = new _Claim.Claim("Fiction City should convert Elm Street to only pedestrian traffic?", (0, _Id.ID)("1"));
  var increaseBusiness = new _Claim.Claim("The planning commission estimates this will increase foot traffic to local shops by 12% during peak hours.", (0, _Id.ID)("2"));
  var increaseTraffic = new _Claim.Claim("This will result in traffic being diverted down residential streets.", (0, _Id.ID)("Traffic"));
  var childSafety = new _Claim.Claim("Children safety is more important than profit for local shops.");
  var newStreet = new _Claim.Claim("A set of railroad tracks are no longer in use and the City can convert that to a new street.");
  var costs = new _Claim.Claim("The conversion will cost 2 Million dollars.");
  var payoff = new _Claim.Claim("The increase in revenue is expected to pay off the expense in under 2 years meeting the cities investment requirements.");
  var testEdgeId = (0, _Id.ID)("TestEdge");
  calcInitator.notify([new _Change.Change(topClaim), new _Change.Change(increaseBusiness), new _Change.Change(new _ClaimEdge.ClaimEdge(topClaim.id, increaseBusiness.id, _Affects.Affects.Confidence, true)), new _Change.Change(increaseTraffic), new _Change.Change(new _ClaimEdge.ClaimEdge(topClaim.id, increaseTraffic.id, _Affects.Affects.Confidence, false, testEdgeId)), new _Change.Change(childSafety), new _Change.Change(new _ClaimEdge.ClaimEdge(increaseTraffic.id, childSafety.id, _Affects.Affects.Relevance, true)), new _Change.Change(newStreet), new _Change.Change(new _ClaimEdge.ClaimEdge(increaseTraffic.id, newStreet.id, _Affects.Affects.Confidence, false)), new _Change.Change(costs), new _Change.Change(new _ClaimEdge.ClaimEdge(topClaim.id, costs.id, _Affects.Affects.Confidence, false)), new _Change.Change(payoff), new _Change.Change(new _ClaimEdge.ClaimEdge(increaseBusiness.id, payoff.id, _Affects.Affects.Relevance, true))]);
  expect(repo.getScoreBySourceClaimId(topClaim.id).confidence).toBe(0.3333333333333333);
  calcInitator.notify([new _Change.Change(increaseTraffic), // Sending in a claim resets it's score to 1 incorrectly
  new _Change.Change(new _ClaimEdge.ClaimEdge(topClaim.id, increaseTraffic.id, _Affects.Affects.Confidence, true, testEdgeId))]);
  expect(repo.getScoreBySourceClaimId(topClaim.id).confidence).toBe(0.3333333333333333);
  calcInitator.notify([new _Change.Change(new _ClaimEdge.ClaimEdge(topClaim.id, increaseTraffic.id, _Affects.Affects.Confidence, false, testEdgeId))]);
  expect(repo.getScoreBySourceClaimId(topClaim.id).confidence).toBe(0.3333333333333333);
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy90ZXN0cy9DYWxjdWxhdGlvbkluaXRpYXRvci50ZXN0LnRzIl0sIm5hbWVzIjpbInRlc3QiLCJyZXBvIiwiUmVwb3NpdG9yeSIsImNhbGNJbml0YXRvciIsIkNhbGN1bGF0aW9uSW5pdGF0b3IiLCJjbGFpbSIsIkNsYWltIiwibm90aWZ5IiwiQ2hhbmdlIiwiZXhwZWN0IiwiZ2V0U2NvcmVCeVNvdXJjZUNsYWltSWQiLCJpZCIsInNvdXJjZUNsYWltSWQiLCJ0b0JlIiwiY29uZmlkZW5jZSIsIm1lYXN1cmVkQ2xhaW0iLCJjaGlsZENsYWltMSIsImRlc2NlbmRhbnRDbGFpbSIsIkNsYWltRWRnZSIsIkFmZmVjdHMiLCJDb25maWRlbmNlIiwiY2hpbGRDbGFpbTIiLCJ1bmRlZmluZWQiLCJtZXNzZW5nZXIiLCJNZXNzZW5nZXIiLCJ0b3BDbGFpbSIsImluY3JlYXNlQnVzaW5lc3MiLCJpbmNyZWFzZVRyYWZmaWMiLCJjaGlsZFNhZmV0eSIsIm5ld1N0cmVldCIsImNvc3RzIiwicGF5b2ZmIiwidGVzdEVkZ2VJZCIsIlJlbGV2YW5jZSJdLCJtYXBwaW5ncyI6Ijs7QUFBQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFHQUEsSUFBSSxDQUFDLGdEQUFELEVBQW1ELFlBQU07QUFDekQsTUFBTUMsSUFBSSxHQUFHLElBQUlDLHNCQUFKLEVBQWI7QUFDQSxNQUFNQyxZQUFZLEdBQUcsSUFBSUMseUNBQUosQ0FBd0JILElBQXhCLENBQXJCO0FBQ0EsTUFBTUksS0FBSyxHQUFHLElBQUlDLFlBQUosQ0FBVSxnQkFBVixFQUE0QixZQUFHLEdBQUgsQ0FBNUIsQ0FBZDtBQUNBSCxFQUFBQSxZQUFZLENBQUNJLE1BQWIsQ0FBb0IsQ0FDaEIsSUFBSUMsY0FBSixDQUFXSCxLQUFYLENBRGdCLENBQXBCO0FBR0FJLEVBQUFBLE1BQU0sQ0FBQ1IsSUFBSSxDQUFDUyx1QkFBTCxDQUE2QkwsS0FBSyxDQUFDTSxFQUFuQyxF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Q0FBb0IsQ0FDaEIsSUFBSUMsY0FBSixDQUFXbUIsZUFBWCxDQURnQixFQUNZO0FBQzVCLE1BQUluQixjQUFKLENBQVcsSUFBSVUsb0JBQUosQ0FBY08sUUFBUSxDQUFDZCxFQUF2QixFQUEyQmdCLGVBQWUsQ0FBQ2hCLEVBQTNDLEVBQStDUSxpQkFBUUMsVUFBdkQsRUFBbUUsSUFBbkUsRUFBeUVZLFVBQXpFLENBQVgsQ0FGZ0IsQ0FBcEI7QUFJQXZCLEVBQUFBLE1BQU0sQ0FBQ1IsSUFBSSxDQUFDUyx1QkFBTCxDQUE2QmUsUUFBUSxDQUFDZCxFQUF0QyxFQUEwQ0csVUFBM0MsQ0FBTixDQUE2REQsSUFBN0QsQ0FBa0Usa0JBQWxFO0FBRUFWLEVBQUFBLFlBQVksQ0FBQ0ksTUFBYixDQUFvQixDQUNoQixJQUFJQyxjQUFKLENBQVcsSUFBSVUsb0JBQUosQ0FBY08sUUFBUSxDQUFDZCxFQUF2QixFQUEyQmdCLGVBQWUsQ0FBQ2hCLEVBQTNDLEVBQStDUSxpQkFBUUMsVUFBdkQsRUFBbUUsS0FBbkUsRUFBMEVZLFVBQTFFLENBQVgsQ0FEZ0IsQ0FBcEI7QUFHQXZCLEVBQUFBLE1BQU0sQ0FBQ1IsSUFBSSxDQUFDUyx1QkFBTCxDQUE2QmUsUUFBUSxDQUFDZCxFQUF0QyxFQUEwQ0csVUFBM0MsQ0FBTixDQUE2REQsSUFBN0QsQ0FBa0Usa0JBQWxFO0FBRUgsQ0ExQ0csQ0FBSiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENhbGN1bGF0aW9uSW5pdGF0b3IgfSBmcm9tIFwiLi4vQ2FsY3VsYXRpb25Jbml0aWF0b3JcIjtcclxuaW1wb3J0IHsgQ2hhbmdlIH0gZnJvbSBcIi4uL2RhdGFNb2RlbHMvQ2hhbmdlXCI7XHJcbmltcG9ydCB7IENsYWltIH0gZnJvbSBcIi4uL2RhdGFNb2RlbHMvQ2xhaW1cIjtcclxuaW1wb3J0IHsgSUQgfSBmcm9tIFwiLi4vZGF0YU1vZGVscy9JZFwiO1xyXG5pbXBvcnQgeyBDbGFpbUVkZ2UgfSBmcm9tIFwiLi4vZGF0YU1vZGVscy9DbGFpbUVkZ2VcIjtcclxuaW1wb3J0IHsgUmVwb3NpdG9yeSB9IGZyb20gXCIuLi9SZXBvc2l0b3J5XCI7XHJcbmltcG9ydCB7IEFmZmVjdHMgfSBmcm9tIFwiLi4vZGF0YU1vZGVscy9BZmZlY3RzXCI7XHJcbmltcG9ydCB7IG5ld0lkLCBNZXNzZW5nZXIgfSBmcm9tIFwiLi5cIjtcclxuXHJcblxyXG50ZXN0KCdjbGFpbSB3aXRob3V0IGFueSBlZGdlcyBzaG91bGQgaGF2ZSBzY29yZSBvZiAxJywgKCkgPT4ge1xyXG4gICAgY29uc3QgcmVwbyA9IG5ldyBSZXBvc2l0b3J5KCk7XHJcbiAgICBjb25zdCBjYWxjSW5pdGF0b3IgPSBuZXcgQ2FsY3VsYXRpb25Jbml0YXRvcihyZXBvKTtcclxuICAgIGNvbnN0IGNsYWltID0gbmV3IENsYWltKFwiTWVhc3VyZWQgQ2xhaW1cIiwgSUQoXCIwXCIpKTtcclxuICAgIGNhbGNJbml0YXRvci5ub3RpZnkoW1xyXG4gICAgICAgIG5ldyBDaGFuZ2UoY2xhaW0pLFxyXG4gICAgXSk7XHJcbiAgICBleHBlY3QocmVwby5nZXRTY29yZUJ5U291cmNlQ2xhaW1JZChjbGFpbS5pZCkuc291cmNlQ2xhaW1JZCkudG9CZShjbGFpbS5pZCk7XHJcbiAgICBleHBlY3QocmVwby5nZXRTY29yZUJ5U291cmNlQ2xhaW1JZChjbGFpbS5pZCkuY29uZmlkZW5jZSkudG9CZSgxKTtcclxuXHJcbn0pO1xyXG5cclxudGVzdCgnY2xhaW0gd2l0aCB0d28gY29uIGRlc2NlbmRhbnRzIHNob3VsZCBoYXZlIGEgY29uZmlkZW5jZSBvZiAwJywgKCkgPT4ge1xyXG4gICAgY29uc3QgcmVwbyA9IG5ldyBSZXBvc2l0b3J5KCk7XHJcbiAgICBjb25zdCBjYWxjSW5pdGF0b3IgPSBuZXcgQ2FsY3VsYXRpb25Jbml0YXRvcihyZXBvKTtcclxuICAgIGNvbnN0IG1lYXN1cmVkQ2xhaW0gPSBuZXcgQ2xhaW0oXCJNZWFzdXJlZCBDbGFpbVwiLCBJRChcIm1lYXN1cmVkQ2xhaW1cIikpO1xyXG4gICAgY29uc3QgY2hpbGRDbGFpbTEgPSBuZXcgQ2xhaW0oXCJDaGlsZCBDbGFpbSAxXCIsIElEKFwiY2hpbGRDbGFpbTFcIikpO1xyXG4gICAgY29uc3QgZGVzY2VuZGFudENsYWltID0gbmV3IENsYWltKFwiRGVzY2VuZGFudCBDbGFpbVwiLCBJRChcImRlc2NlbmRhbnRDbGFpbVwiKSk7XHJcbiAgICBjYWxjSW5pdGF0b3Iubm90aWZ5KFtcclxuICAgICAgICBuZXcgQ2hhbmdlKG1lYXN1cmVkQ2xhaW0pLFxyXG4gICAgICAgIG5ldyBDaGFuZ2UoY2hpbGRDbGFpbTEpLFxyXG4gICAgICAgIG5ldyBDaGFuZ2UoZGVzY2VuZGFudENsYWltKSxcclxuICAgICAgICBuZXcgQ2hhbmdlKG5ldyBDbGFpbUVkZ2UobWVhc3VyZWRDbGFpbS5pZCwgY2hpbGRDbGFpbTEuaWQsIEFmZmVjdHMuQ29uZmlkZW5jZSwgZmFsc2UpKSxcclxuICAgICAgICBuZXcgQ2hhbmdlKG5ldyBDbGFpbUVkZ2UoY2hpbGRDbGFpbTEuaWQsIGRlc2NlbmRhbnRDbGFpbS5pZCwgQWZmZWN0cy5Db25maWRlbmNlLCBmYWxzZSkpLFxyXG4gICAgXSk7XHJcbiAgICBleHBlY3QocmVwby5nZXRTY29yZUJ5U291cmNlQ2xhaW1JZChtZWFzdXJlZENsYWltLmlkKS5jb25maWRlbmNlKS50b0JlKDApO1xyXG59KTtcclxuXHJcbnRlc3QoJ2NsYWltIHdpdGggdHdvIGNvbiBkZXNjZW5kYW50cyBhbmQgb3RoZXIgY2hpbGRyZW4gc2hvdWxkIGhhdmUgYSBjb25maWRlbmNlIG9mIDEnLCAoKSA9PiB7XHJcbiAgICBjb25zdCByZXBvID0gbmV3IFJlcG9zaXRvcnkoKTtcclxuICAgIGNvbnN0IGNhbGNJbml0YXRvciA9IG5ldyBDYWxjdWxhdGlvbkluaXRhdG9yKHJlcG8pO1xyXG4gICAgY29uc3QgbWVhc3VyZWRDbGFpbSA9IG5ldyBDbGFpbShcIk1lYXN1cmVkIENsYWltXCIsIElEKFwibWVhc3VyZWRDbGFpbVwiKSk7XHJcbiAgICBjb25zdCBjaGlsZENsYWltMSA9IG5ldyBDbGFpbShcIkNoaWxkIENsYWltIDFcIiwgSUQoXCJjaGlsZENsYWltMVwiKSk7XHJcbiAgICBjb25zdCBjaGlsZENsYWltMiA9IG5ldyBDbGFpbShcIkNoaWxkIENsYWltIDJcIiwgSUQoXCJjaGlsZENsYWltMlwiKSk7XHJcbiAgICBjb25zdCBkZXNjZW5kYW50Q2xhaW0gPSBuZXcgQ2xhaW0oXCJEZXNjZW5kYW50IENsYWltXCIsIElEKFwiZGVzY2VuZGFudENsYWltXCIpKTtcclxuICAgIGNhbGNJbml0YXRvci5ub3RpZnkoW1xyXG4gICAgICAgIG5ldyBDaGFuZ2UobWVhc3VyZWRDbGFpbSksXHJcbiAgICAgICAgbmV3IENoYW5nZShjaGlsZENsYWltMSksXHJcbiAgICAgICAgbmV3IENoYW5nZShkZXNjZW5kYW50Q2xhaW0pLFxyXG4gICAgICAgIG5ldyBDaGFuZ2UobmV3IENsYWltRWRnZShtZWFzdXJlZENsYWltLmlkLCBjaGlsZENsYWltMS5pZCwgQWZmZWN0cy5Db25maWRlbmNlLCBmYWxzZSkpLFxyXG4gICAgICAgIG5ldyBDaGFuZ2UobmV3IENsYWltRWRnZShtZWFzdXJlZENsYWltLmlkLCBjaGlsZENsYWltMi5pZCwgQWZmZWN0cy5Db25maWRlbmNlLCB0cnVlKSksXHJcbiAgICAgICAgbmV3IENoYW5nZShuZXcgQ2xhaW1FZGdlKGNoaWxkQ2xhaW0xLmlkLCBkZXNjZW5kYW50Q2xhaW0uaWQsIEFmZmVjdHMuQ29uZmlkZW5jZSwgZmFsc2UpKSxcclxuICAgIF0pO1xyXG4gICAgZXhwZWN0KHJlcG8uZ2V0U2NvcmVCeVNvdXJjZUNsYWltSWQobWVhc3VyZWRDbGFpbS5pZCkuY29uZmlkZW5jZSkudG9CZSgxKTtcclxufSk7XHJcblxyXG50ZXN0KCdNdWx0aXBsZSBjaGlsZHJlbiBjYWxjdWxhdGlvbicsICgpID0+IHtcclxuICAgIGNvbnN0IHJlcG8gPSBuZXcgUmVwb3NpdG9yeSgpO1xyXG4gICAgY29uc3QgY2FsY0luaXRhdG9yID0gbmV3IENhbGN1bGF0aW9uSW5pdGF0b3IocmVwbyk7XHJcbiAgICBjb25zdCBtZWFzdXJlZENsYWltID0gbmV3IENsYWltKFwiTWVhc3VyZWQgQ2xhaW1cIiwgSUQoXCJtZWFzdXJlZENsYWltXCIpKTtcclxuICAgIGNvbnN0IGNoaWxkQ2xhaW0xID0gbmV3IENsYWltKFwiQ2hpbGQgQ2xhaW0gMVwiLCBJRChcImNoaWxkQ2xhaW0xXCIpKTtcclxuICAgIGNvbnN0IGNoaWxkQ2xhaW0yID0gbmV3IENsYWltKFwiQ2hpbGQgQ2xhaW0gMlwiLCBJRChcImNoaWxkQ2xhaW0yXCIpKTtcclxuICAgIGNvbnN0IGRlc2NlbmRhbnRDbGFpbSA9IG5ldyBDbGFpbShcIkRlc2NlbmRhbnQgQ2xhaW1cIiwgSUQoXCJkZXNjZW5kYW50Q2xhaW1cIikpO1xyXG4gICAgY2FsY0luaXRhdG9yLm5vdGlmeShbXHJcbiAgICAgICAgbmV3IENoYW5nZShtZWFzdXJlZENsYWltKSxcclxuICAgICAgICBuZXcgQ2hhbmdlKGNoaWxkQ2xhaW0xKSxcclxuICAgICAgICBuZXcgQ2hhbmdlKGNoaWxkQ2xhaW0yKSxcclxuICAgICAgICBuZXcgQ2hhbmdlKGRlc2NlbmRhbnRDbGFpbSksXHJcbiAgICAgICAgbmV3IENoYW5nZShuZXcgQ2xhaW1FZGdlKG1lYXN1cmVkQ2xhaW0uaWQsIGNoaWxkQ2xhaW0xLmlkLCBBZmZlY3RzLkNvbmZpZGVuY2UsIGZhbHNlKSksXHJcbiAgICAgICAgbmV3IENoYW5nZShuZXcgQ2xhaW1FZGdlKG1lYXN1cmVkQ2xhaW0uaWQsIGNoaWxkQ2xhaW0yLmlkLCBBZmZlY3RzLkNvbmZpZGVuY2UsIGZhbHNlKSksXHJcbiAgICAgICAgbmV3IENoYW5nZShuZXcgQ2xhaW1FZGdlKGNoaWxkQ2xhaW0xLmlkLCBkZXNjZW5kYW50Q2xhaW0uaWQsIEFmZmVjdHMuQ29uZmlkZW5jZSwgZmFsc2UpKSxcclxuICAgIF0pO1xyXG4gICAgZXhwZWN0KHJlcG8uZ2V0U2NvcmVCeVNvdXJjZUNsYWltSWQobWVhc3VyZWRDbGFpbS5pZCkuY29uZmlkZW5jZSkudG9CZSgwKTtcclxufSk7XHJcblxyXG50ZXN0KCdEZWZhdWx0IE5vdCBSZXZlcnNhYmxlJywgKCkgPT4ge1xyXG4gICAgY29uc3QgcmVwbyA9IG5ldyBSZXBvc2l0b3J5KCk7XHJcbiAgICBjb25zdCBjYWxjSW5pdGF0b3IgPSBuZXcgQ2FsY3VsYXRpb25Jbml0YXRvcihyZXBvKTtcclxuICAgIGNvbnN0IG1lYXN1cmVkQ2xhaW0gPSBuZXcgQ2xhaW0oXCJNZWFzdXJlZCBDbGFpbVwiLCBJRChcIm1lYXN1cmVkQ2xhaW1cIikpO1xyXG4gICAgY29uc3QgY2hpbGRDbGFpbTEgPSBuZXcgQ2xhaW0oXCJDaGlsZCBDbGFpbSAxXCIsIElEKFwiY2hpbGRDbGFpbTFcIikpO1xyXG4gICAgY2FsY0luaXRhdG9yLm5vdGlmeShbXHJcbiAgICAgICAgbmV3IENoYW5nZShtZWFzdXJlZENsYWltKSxcclxuICAgICAgICBuZXcgQ2hhbmdlKGNoaWxkQ2xhaW0xKSxcclxuICAgICAgICBuZXcgQ2hhbmdlKG5ldyBDbGFpbUVkZ2UobWVhc3VyZWRDbGFpbS5pZCwgY2hpbGRDbGFpbTEuaWQsIEFmZmVjdHMuQ29uZmlkZW5jZSwgZmFsc2UpKSxcclxuICAgIF0pO1xyXG4gICAgZXhwZWN0KHJlcG8uZ2V0U2NvcmVCeVNvdXJjZUNsYWltSWQobWVhc3VyZWRDbGFpbS5pZCkuY29uZmlkZW5jZSkudG9CZSgwKTtcclxufSk7XHJcblxyXG50ZXN0KCdSZXZlcnNhYmxlJywgKCkgPT4ge1xyXG4gICAgY29uc3QgcmVwbyA9IG5ldyBSZXBvc2l0b3J5KCk7XHJcbiAgICBjb25zdCBjYWxjSW5pdGF0b3IgPSBuZXcgQ2FsY3VsYXRpb25Jbml0YXRvcihyZXBvKTtcclxuICAgIGNvbnN0IG1lYXN1cmVkQ2xhaW0gPSBuZXcgQ2xhaW0oXCJNZWFzdXJlZCBDbGFpbVwiLCBJRChcIm1lYXN1cmVkQ2xhaW1cIiksIHVuZGVmaW5lZCwgdW5kZWZpbmVkLCB1bmRlZmluZWQsIHRydWUpO1xyXG4gICAgY29uc3QgY2hpbGRDbGFpbTEgPSBuZXcgQ2xhaW0oXCJDaGlsZCBDbGFpbSAxXCIsIElEKFwiY2hpbGRDbGFpbTFcIikpO1xyXG4gICAgY2FsY0luaXRhdG9yLm5vdGlmeShbXHJcbiAgICAgICAgbmV3IENoYW5nZShtZWFzdXJlZENsYWltKSxcclxuICAgICAgICBuZXcgQ2hhbmdlKGNoaWxkQ2xhaW0xKSxcclxuICAgICAgICBuZXcgQ2hhbmdlKG5ldyBDbGFpbUVkZ2UobWVhc3VyZWRDbGFpbS5pZCwgY2hpbGRDbGFpbTEuaWQsIEFmZmVjdHMuQ29uZmlkZW5jZSwgZmFsc2UpKSxcclxuICAgIF0pO1xyXG4gICAgZXhwZWN0KHJlcG8uZ2V0U2NvcmVCeVNvdXJjZUNsYWltSWQobWVhc3VyZWRDbGFpbS5pZCkuY29uZmlkZW5jZSkudG9CZSgtMSk7XHJcbn0pO1xyXG5cclxudGVzdCgnV2VpcmQgdGVzdCBjYXNlJywgKCkgPT4ge1xyXG4gICAgY29uc3QgcmVwbyA9IG5ldyBSZXBvc2l0b3J5KCk7XHJcbiAgICBjb25zdCBtZXNzZW5nZXIgPSBuZXcgTWVzc2VuZ2VyKCk7XHJcbiAgICBjb25zdCBjYWxjSW5pdGF0b3IgPSBuZXcgQ2FsY3VsYXRpb25Jbml0YXRvcihyZXBvLCBtZXNzZW5nZXIubm90aWZ5KTtcclxuICAgIGNvbnN0IHRvcENsYWltID0gbmV3IENsYWltKFwiRmljdGlvbiBDaXR5IHNob3VsZCBjb252ZXJ0IEVsbSBTdHJlZXQgdG8gb25seSBwZWRlc3RyaWFuIHRyYWZmaWM/XCIsIElEKFwiMVwiKSk7XHJcbiAgICBjb25zdCBpbmNyZWFzZUJ1c2luZXNzID0gbmV3IENsYWltKFwiVGhlIHBsYW5uaW5nIGNvbW1pc3Npb24gZXN0aW1hdGVzIHRoaXMgd2lsbCBpbmNyZWFzZSBmb290IHRyYWZmaWMgdG8gbG9jYWwgc2hvcHMgYnkgMTIlIGR1cmluZyBwZWFrIGhvdXJzLlwiLCBJRChcIjJcIikpO1xyXG4gICAgY29uc3QgaW5jcmVhc2VUcmFmZmljID0gbmV3IENsYWltKFwiVGhpcyB3aWxsIHJlc3VsdCBpbiB0cmFmZmljIGJlaW5nIGRpdmVydGVkIGRvd24gcmVzaWRlbnRpYWwgc3RyZWV0cy5cIiwgSUQoXCJUcmFmZmljXCIpKTtcclxuICAgIGNvbnN0IGNoaWxkU2FmZXR5ID0gbmV3IENsYWltKFwiQ2hpbGRyZW4gc2FmZXR5IGlzIG1vcmUgaW1wb3J0YW50IHRoYW4gcHJvZml0IGZvciBsb2NhbCBzaG9wcy5cIik7XHJcbiAgICBjb25zdCBuZXdTdHJlZXQgPSBuZXcgQ2xhaW0oXCJBIHNldCBvZiByYWlscm9hZCB0cmFja3MgYXJlIG5vIGxvbmdlciBpbiB1c2UgYW5kIHRoZSBDaXR5IGNhbiBjb252ZXJ0IHRoYXQgdG8gYSBuZXcgc3RyZWV0LlwiKTtcclxuICAgIGNvbnN0IGNvc3RzID0gbmV3IENsYWltKFwiVGhlIGNvbnZlcnNpb24gd2lsbCBjb3N0IDIgTWlsbGlvbiBkb2xsYXJzLlwiKTtcclxuICAgIGNvbnN0IHBheW9mZiA9IG5ldyBDbGFpbShcIlRoZSBpbmNyZWFzZSBpbiByZXZlbnVlIGlzIGV4cGVjdGVkIHRvIHBheSBvZmYgdGhlIGV4cGVuc2UgaW4gdW5kZXIgMiB5ZWFycyBtZWV0aW5nIHRoZSBjaXRpZXMgaW52ZXN0bWVudCByZXF1aXJlbWVudHMuXCIpO1xyXG5cclxuICAgIGNvbnN0IHRlc3RFZGdlSWQgPSBJRChcIlRlc3RFZGdlXCIpXHJcblxyXG4gICAgY2FsY0luaXRhdG9yLm5vdGlmeShbXHJcbiAgICAgICAgbmV3IENoYW5nZSh0b3BDbGFpbSksXHJcbiAgICAgICAgbmV3IENoYW5nZShpbmNyZWFzZUJ1c2luZXNzKSxcclxuICAgICAgICBuZXcgQ2hhbmdlKG5ldyBDbGFpbUVkZ2UodG9wQ2xhaW0uaWQsIGluY3JlYXNlQnVzaW5lc3MuaWQsIEFmZmVjdHMuQ29uZmlkZW5jZSwgdHJ1ZSkpLFxyXG4gICAgICAgIG5ldyBDaGFuZ2UoaW5jcmVhc2VUcmFmZmljKSxcclxuICAgICAgICBuZXcgQ2hhbmdlKG5ldyBDbGFpbUVkZ2UodG9wQ2xhaW0uaWQsIGluY3JlYXNlVHJhZmZpYy5pZCwgQWZmZWN0cy5Db25maWRlbmNlLCBmYWxzZSwgdGVzdEVkZ2VJZCkpLFxyXG4gICAgICAgIG5ldyBDaGFuZ2UoY2hpbGRTYWZldHkpLFxyXG4gICAgICAgIG5ldyBDaGFuZ2UobmV3IENsYWltRWRnZShpbmNyZWFzZVRyYWZmaWMuaWQsIGNoaWxkU2FmZXR5LmlkLCBBZmZlY3RzLlJlbGV2YW5jZSwgdHJ1ZSkpLFxyXG4gICAgICAgIG5ldyBDaGFuZ2UobmV3U3RyZWV0KSxcclxuICAgICAgICBuZXcgQ2hhbmdlKG5ldyBDbGFpbUVkZ2UoaW5jcmVhc2VUcmFmZmljLmlkLCBuZXdTdHJlZXQuaWQsIEFmZmVjdHMuQ29uZmlkZW5jZSwgZmFsc2UpKSxcclxuICAgICAgICBuZXcgQ2hhbmdlKGNvc3RzKSxcclxuICAgICAgICBuZXcgQ2hhbmdlKG5ldyBDbGFpbUVkZ2UodG9wQ2xhaW0uaWQsIGNvc3RzLmlkLCBBZmZlY3RzLkNvbmZpZGVuY2UsIGZhbHNlKSksXHJcbiAgICAgICAgbmV3IENoYW5nZShwYXlvZmYpLFxyXG4gICAgICAgIG5ldyBDaGFuZ2UobmV3IENsYWltRWRnZShpbmNyZWFzZUJ1c2luZXNzLmlkLCBwYXlvZmYuaWQsIEFmZmVjdHMuUmVsZXZhbmNlLCB0cnVlKSksXHJcbiAgICBdKTtcclxuICAgIGV4cGVjdChyZXBvLmdldFNjb3JlQnlTb3VyY2VDbGFpbUlkKHRvcENsYWltLmlkKS5jb25maWRlbmNlKS50b0JlKDAuMzMzMzMzMzMzMzMzMzMzMyk7XHJcblxyXG4gICAgY2FsY0luaXRhdG9yLm5vdGlmeShbXHJcbiAgICAgICAgbmV3IENoYW5nZShpbmNyZWFzZVRyYWZmaWMpLC8vIFNlbmRpbmcgaW4gYSBjbGFpbSByZXNldHMgaXQncyBzY29yZSB0byAxIGluY29ycmVjdGx5XHJcbiAgICAgICAgbmV3IENoYW5nZShuZXcgQ2xhaW1FZGdlKHRvcENsYWltLmlkLCBpbmNyZWFzZVRyYWZmaWMuaWQsIEFmZmVjdHMuQ29uZmlkZW5jZSwgdHJ1ZSwgdGVzdEVkZ2VJZCkpLFxyXG4gICAgXSk7XHJcbiAgICBleHBlY3QocmVwby5nZXRTY29yZUJ5U291cmNlQ2xhaW1JZCh0b3BDbGFpbS5pZCkuY29uZmlkZW5jZSkudG9CZSgwLjMzMzMzMzMzMzMzMzMzMzMpO1xyXG5cclxuICAgIGNhbGNJbml0YXRvci5ub3RpZnkoW1xyXG4gICAgICAgIG5ldyBDaGFuZ2UobmV3IENsYWltRWRnZSh0b3BDbGFpbS5pZCwgaW5jcmVhc2VUcmFmZmljLmlkLCBBZmZlY3RzLkNvbmZpZGVuY2UsIGZhbHNlLCB0ZXN0RWRnZUlkKSksXHJcbiAgICBdKTtcclxuICAgIGV4cGVjdChyZXBvLmdldFNjb3JlQnlTb3VyY2VDbGFpbUlkKHRvcENsYWltLmlkKS5jb25maWRlbmNlKS50b0JlKDAuMzMzMzMzMzMzMzMzMzMzMyk7XHJcblxyXG59KTsiXX0=