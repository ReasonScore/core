"use strict";

var _CalculationInitiator = require("../CalculationInitiator");

var _Change = require("../dataModels/Change");

var _Claim = require("../dataModels/Claim");

var _Id = require("../dataModels/Id");

var _ClaimEdge = require("../dataModels/ClaimEdge");

var _Repository = require("../Repository");

var _Affects = require("../dataModels/Affects");

test('claim without any edges should have score of 1', function () {
  var repo = new _Repository.Repository();
  var calcInitator = new _CalculationInitiator.CalculationInitator(repo);
  var claim = new _Claim.Claim("Measured Claim", (0, _Id.ID)("0"));
  calcInitator.notify([new _Change.Change(claim)]);
  expect(repo.getScoreBySourceClaimId(claim.id).sourceClaimId).toBe(claim.id);
  expect(repo.getScoreBySourceClaimId(claim.id).confidence).toBe(1);
});
test('claim with two con descendants should have a confidence of 0', function () {
  var repo = new _Repository.Repository();
  var calcInitator = new _CalculationInitiator.CalculationInitator(repo);
  var measuredClaim = new _Claim.Claim("Measured Claim", (0, _Id.ID)("measuredClaim"));
  var childClaim1 = new _Claim.Claim("Child Claim 1", (0, _Id.ID)("childClaim1"));
  var descendantClaim = new _Claim.Claim("Descendant Claim", (0, _Id.ID)("descendantClaim"));
  calcInitator.notify([new _Change.Change(measuredClaim), new _Change.Change(childClaim1), new _Change.Change(descendantClaim), new _Change.Change(new _ClaimEdge.ClaimEdge(measuredClaim.id, childClaim1.id, _Affects.Affects.Confidence, false)), new _Change.Change(new _ClaimEdge.ClaimEdge(childClaim1.id, descendantClaim.id, _Affects.Affects.Confidence, false))]);
  expect(repo.getScoreBySourceClaimId(measuredClaim.id).confidence).toBe(0);
});
test('claim with two con descendants and other children should have a confidence of 1', function () {
  var repo = new _Repository.Repository();
  var calcInitator = new _CalculationInitiator.CalculationInitator(repo);
  var measuredClaim = new _Claim.Claim("Measured Claim", (0, _Id.ID)("measuredClaim"));
  var childClaim1 = new _Claim.Claim("Child Claim 1", (0, _Id.ID)("childClaim1"));
  var childClaim2 = new _Claim.Claim("Child Claim 2", (0, _Id.ID)("childClaim2"));
  var descendantClaim = new _Claim.Claim("Descendant Claim", (0, _Id.ID)("descendantClaim"));
  calcInitator.notify([new _Change.Change(measuredClaim), new _Change.Change(childClaim1), new _Change.Change(descendantClaim), new _Change.Change(new _ClaimEdge.ClaimEdge(measuredClaim.id, childClaim1.id, _Affects.Affects.Confidence, false)), new _Change.Change(new _ClaimEdge.ClaimEdge(measuredClaim.id, childClaim2.id, _Affects.Affects.Confidence, true)), new _Change.Change(new _ClaimEdge.ClaimEdge(childClaim1.id, descendantClaim.id, _Affects.Affects.Confidence, false))]);
  expect(repo.getScoreBySourceClaimId(measuredClaim.id).confidence).toBe(1);
});
test('Multiple children calculation', function () {
  var repo = new _Repository.Repository();
  var calcInitator = new _CalculationInitiator.CalculationInitator(repo);
  var measuredClaim = new _Claim.Claim("Measured Claim", (0, _Id.ID)("measuredClaim"));
  var childClaim1 = new _Claim.Claim("Child Claim 1", (0, _Id.ID)("childClaim1"));
  var childClaim2 = new _Claim.Claim("Child Claim 2", (0, _Id.ID)("childClaim2"));
  var descendantClaim = new _Claim.Claim("Descendant Claim", (0, _Id.ID)("descendantClaim"));
  calcInitator.notify([new _Change.Change(measuredClaim), new _Change.Change(childClaim1), new _Change.Change(childClaim2), new _Change.Change(descendantClaim), new _Change.Change(new _ClaimEdge.ClaimEdge(measuredClaim.id, childClaim1.id, _Affects.Affects.Confidence, false)), new _Change.Change(new _ClaimEdge.ClaimEdge(measuredClaim.id, childClaim2.id, _Affects.Affects.Confidence, false)), new _Change.Change(new _ClaimEdge.ClaimEdge(childClaim1.id, descendantClaim.id, _Affects.Affects.Confidence, false))]);
  expect(repo.getScoreBySourceClaimId(measuredClaim.id).confidence).toBe(0);
});
test('Default Not Reversable', function () {
  var repo = new _Repository.Repository();
  var calcInitator = new _CalculationInitiator.CalculationInitator(repo);
  var measuredClaim = new _Claim.Claim("Measured Claim", (0, _Id.ID)("measuredClaim"));
  var childClaim1 = new _Claim.Claim("Child Claim 1", (0, _Id.ID)("childClaim1"));
  calcInitator.notify([new _Change.Change(measuredClaim), new _Change.Change(childClaim1), new _Change.Change(new _ClaimEdge.ClaimEdge(measuredClaim.id, childClaim1.id, _Affects.Affects.Confidence, false))]);
  expect(repo.getScoreBySourceClaimId(measuredClaim.id).confidence).toBe(0);
});
test('Reversable', function () {
  var repo = new _Repository.Repository();
  var calcInitator = new _CalculationInitiator.CalculationInitator(repo);
  var measuredClaim = new _Claim.Claim("Measured Claim", (0, _Id.ID)("measuredClaim"), undefined, undefined, undefined, true);
  var childClaim1 = new _Claim.Claim("Child Claim 1", (0, _Id.ID)("childClaim1"));
  calcInitator.notify([new _Change.Change(measuredClaim), new _Change.Change(childClaim1), new _Change.Change(new _ClaimEdge.ClaimEdge(measuredClaim.id, childClaim1.id, _Affects.Affects.Confidence, false))]);
  expect(repo.getScoreBySourceClaimId(measuredClaim.id).confidence).toBe(-1);
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy90ZXN0cy9DYWxjdWxhdGlvbkluaXRpYXRvci50ZXN0LnRzIl0sIm5hbWVzIjpbInRlc3QiLCJyZXBvIiwiUmVwb3NpdG9yeSIsImNhbGNJbml0YXRvciIsIkNhbGN1bGF0aW9uSW5pdGF0b3IiLCJjbGFpbSIsIkNsYWltIiwibm90aWZ5IiwiQ2hhbmdlIiwiZXhwZWN0IiwiZ2V0U2NvcmVCeVNvdXJjZUNsYWltSWQiLCJpZCIsInNvdXJjZUNsYWltSWQiLCJ0b0JlIiwiY29uZmlkZW5jZSIsIm1lYXN1cmVkQ2xhaW0iLCJjaGlsZENsYWltMSIsImRlc2NlbmRhbnRDbGFpbSIsIkNsYWltRWRnZSIsIkFmZmVjdHMiLCJDb25maWRlbmNlIiwiY2hpbGRDbGFpbTIiLCJ1bmRlZmluZWQiXSwibWFwcGluZ3MiOiI7O0FBQUE7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBR0FBLElBQUksQ0FBQyxnREFBRCxFQUFtRCxZQUFNO0FBQ3pELE1BQU1DLElBQUksR0FBRyxJQUFJQyxzQkFBSixFQUFiO0FBQ0EsTUFBTUMsWUFBWSxHQUFHLElBQUlDLHlDQUFKLENBQXdCSCxJQUF4QixDQUFyQjtBQUNBLE1BQU1JLEtBQUssR0FBRyxJQUFJQyxZQUFKLENBQVUsZ0JBQVYsRUFBNEIsWUFBRyxHQUFILENBQTVCLENBQWQ7QUFDQUgsRUFBQUEsWUFBWSxDQUFDSSxNQUFiLENBQW9CLENBQ2hCLElBQUlDLGNBQUosQ0FBV0gsS0FBWCxDQURnQixDQUFwQjtBQUdBSSxFQUFBQSxNQUFNLENBQUNSLElBQUksQ0FBQ1MsdUJBQUwsQ0FBNkJMLEtBQUssQ0FBQ00sRUFBbkMsRUFBdUNDLGFBQXhDLENBQU4sQ0FBNkRDLElBQTdELENBQWtFUixLQUFLLENBQUNNLEVBQXhFO0FBQ0FGLEVBQUFBLE1BQU0sQ0FBQ1IsSUFBSSxDQUFDUyx1QkFBTCxDQUE2QkwsS0FBSyxDQUFDTSxFQUFuQyxFQUF1Q0csVUFBeEMsQ0FBTixDQUEwREQsSUFB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RSxDQUF2RTtBQUNILENBWEcsQ0FBSjtBQWFBYixJQUFJLENBQUMsWUFBRCxFQUFlLFlBQU07QUFDckIsTUFBTUMsSUFBSSxHQUFHLElBQUlDLHNCQUFKLEVBQWI7QUFDQSxNQUFNQyxZQUFZLEdBQUcsSUFBSUMseUNBQUosQ0FBd0JILElBQXhCLENBQXJCO0FBQ0EsTUFBTWMsYUFBYSxHQUFHLElBQUlULFlBQUosQ0FBVSxnQkFBVixFQUE0QixZQUFHLGVBQUgsQ0FBNUIsRUFBaURnQixTQUFqRCxFQUE0REEsU0FBNUQsRUFBdUVBLFNBQXZFLEVBQWtGLElBQWxGLENBQXRCO0FBQ0EsTUFBTU4sV0FBVyxHQUFHLElBQUlWLFlBQUosQ0FBVSxlQUFWLEVBQTJCLFlBQUcsYUFBSCxDQUEzQixDQUFwQjtBQUNBSCxFQUFBQSxZQUFZLENBQUNJLE1BQWIsQ0FBb0IsQ0FDaEIsSUFBSUMsY0FBSixDQUFXTyxhQUFYLENBRGdCLEVBRWhCLElBQUlQLGNBQUosQ0FBV1EsV0FBWCxDQUZnQixFQUdoQixJQUFJUixjQUFKLENBQVcsSUFBSVUsb0JBQUosQ0FBY0gsYUFBYSxDQUFDSixFQUE1QixFQUFnQ0ssV0FBVyxDQUFDTCxFQUE1QyxFQUFnRFEsaUJBQVFDLFVBQXhELEVBQW9FLEtBQXBFLENBQVgsQ0FIZ0IsQ0FBcEI7QUFLQVgsRUFBQUEsTUFBTSxDQUFDUixJQUFJLENBQUNTLHVCQUFMLENBQTZCSyxhQUFhLENBQUNKLEVBQTNDLEVBQStDRyxVQUFoRCxDQUFOLENBQWtFRCxJQUFsRSxDQUF1RSxDQUFDLENBQXhFO0FBQ0gsQ0FYRyxDQUFKIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ2FsY3VsYXRpb25Jbml0YXRvciB9IGZyb20gXCIuLi9DYWxjdWxhdGlvbkluaXRpYXRvclwiO1xyXG5pbXBvcnQgeyBDaGFuZ2UgfSBmcm9tIFwiLi4vZGF0YU1vZGVscy9DaGFuZ2VcIjtcclxuaW1wb3J0IHsgQ2xhaW0gfSBmcm9tIFwiLi4vZGF0YU1vZGVscy9DbGFpbVwiO1xyXG5pbXBvcnQgeyBJRCB9IGZyb20gXCIuLi9kYXRhTW9kZWxzL0lkXCI7XHJcbmltcG9ydCB7IENsYWltRWRnZSB9IGZyb20gXCIuLi9kYXRhTW9kZWxzL0NsYWltRWRnZVwiO1xyXG5pbXBvcnQgeyBSZXBvc2l0b3J5IH0gZnJvbSBcIi4uL1JlcG9zaXRvcnlcIjtcclxuaW1wb3J0IHsgQWZmZWN0cyB9IGZyb20gXCIuLi9kYXRhTW9kZWxzL0FmZmVjdHNcIjtcclxuXHJcblxyXG50ZXN0KCdjbGFpbSB3aXRob3V0IGFueSBlZGdlcyBzaG91bGQgaGF2ZSBzY29yZSBvZiAxJywgKCkgPT4ge1xyXG4gICAgY29uc3QgcmVwbyA9IG5ldyBSZXBvc2l0b3J5KCk7XHJcbiAgICBjb25zdCBjYWxjSW5pdGF0b3IgPSBuZXcgQ2FsY3VsYXRpb25Jbml0YXRvcihyZXBvKTtcclxuICAgIGNvbnN0IGNsYWltID0gbmV3IENsYWltKFwiTWVhc3VyZWQgQ2xhaW1cIiwgSUQoXCIwXCIpKTtcclxuICAgIGNhbGNJbml0YXRvci5ub3RpZnkoW1xyXG4gICAgICAgIG5ldyBDaGFuZ2UoY2xhaW0pLFxyXG4gICAgXSk7XHJcbiAgICBleHBlY3QocmVwby5nZXRTY29yZUJ5U291cmNlQ2xhaW1JZChjbGFpbS5pZCkuc291cmNlQ2xhaW1JZCkudG9CZShjbGFpbS5pZCk7XHJcbiAgICBleHBlY3QocmVwby5nZXRTY29yZUJ5U291cmNlQ2xhaW1JZChjbGFpbS5pZCkuY29uZmlkZW5jZSkudG9CZSgxKTtcclxuXHJcbn0pO1xyXG5cclxudGVzdCgnY2xhaW0gd2l0aCB0d28gY29uIGRlc2NlbmRhbnRzIHNob3VsZCBoYXZlIGEgY29uZmlkZW5jZSBvZiAwJywgKCkgPT4ge1xyXG4gICAgY29uc3QgcmVwbyA9IG5ldyBSZXBvc2l0b3J5KCk7XHJcbiAgICBjb25zdCBjYWxjSW5pdGF0b3IgPSBuZXcgQ2FsY3VsYXRpb25Jbml0YXRvcihyZXBvKTtcclxuICAgIGNvbnN0IG1lYXN1cmVkQ2xhaW0gPSBuZXcgQ2xhaW0oXCJNZWFzdXJlZCBDbGFpbVwiLCBJRChcIm1lYXN1cmVkQ2xhaW1cIikpO1xyXG4gICAgY29uc3QgY2hpbGRDbGFpbTEgPSBuZXcgQ2xhaW0oXCJDaGlsZCBDbGFpbSAxXCIsIElEKFwiY2hpbGRDbGFpbTFcIikpO1xyXG4gICAgY29uc3QgZGVzY2VuZGFudENsYWltID0gbmV3IENsYWltKFwiRGVzY2VuZGFudCBDbGFpbVwiLCBJRChcImRlc2NlbmRhbnRDbGFpbVwiKSk7XHJcbiAgICBjYWxjSW5pdGF0b3Iubm90aWZ5KFtcclxuICAgICAgICBuZXcgQ2hhbmdlKG1lYXN1cmVkQ2xhaW0pLFxyXG4gICAgICAgIG5ldyBDaGFuZ2UoY2hpbGRDbGFpbTEpLFxyXG4gICAgICAgIG5ldyBDaGFuZ2UoZGVzY2VuZGFudENsYWltKSxcclxuICAgICAgICBuZXcgQ2hhbmdlKG5ldyBDbGFpbUVkZ2UobWVhc3VyZWRDbGFpbS5pZCwgY2hpbGRDbGFpbTEuaWQsIEFmZmVjdHMuQ29uZmlkZW5jZSwgZmFsc2UpKSxcclxuICAgICAgICBuZXcgQ2hhbmdlKG5ldyBDbGFpbUVkZ2UoY2hpbGRDbGFpbTEuaWQsIGRlc2NlbmRhbnRDbGFpbS5pZCwgQWZmZWN0cy5Db25maWRlbmNlLCBmYWxzZSkpLFxyXG4gICAgXSk7XHJcbiAgICBleHBlY3QocmVwby5nZXRTY29yZUJ5U291cmNlQ2xhaW1JZChtZWFzdXJlZENsYWltLmlkKS5jb25maWRlbmNlKS50b0JlKDApO1xyXG59KTtcclxuXHJcbnRlc3QoJ2NsYWltIHdpdGggdHdvIGNvbiBkZXNjZW5kYW50cyBhbmQgb3RoZXIgY2hpbGRyZW4gc2hvdWxkIGhhdmUgYSBjb25maWRlbmNlIG9mIDEnLCAoKSA9PiB7XHJcbiAgICBjb25zdCByZXBvID0gbmV3IFJlcG9zaXRvcnkoKTtcclxuICAgIGNvbnN0IGNhbGNJbml0YXRvciA9IG5ldyBDYWxjdWxhdGlvbkluaXRhdG9yKHJlcG8pO1xyXG4gICAgY29uc3QgbWVhc3VyZWRDbGFpbSA9IG5ldyBDbGFpbShcIk1lYXN1cmVkIENsYWltXCIsIElEKFwibWVhc3VyZWRDbGFpbVwiKSk7XHJcbiAgICBjb25zdCBjaGlsZENsYWltMSA9IG5ldyBDbGFpbShcIkNoaWxkIENsYWltIDFcIiwgSUQoXCJjaGlsZENsYWltMVwiKSk7XHJcbiAgICBjb25zdCBjaGlsZENsYWltMiA9IG5ldyBDbGFpbShcIkNoaWxkIENsYWltIDJcIiwgSUQoXCJjaGlsZENsYWltMlwiKSk7XHJcbiAgICBjb25zdCBkZXNjZW5kYW50Q2xhaW0gPSBuZXcgQ2xhaW0oXCJEZXNjZW5kYW50IENsYWltXCIsIElEKFwiZGVzY2VuZGFudENsYWltXCIpKTtcclxuICAgIGNhbGNJbml0YXRvci5ub3RpZnkoW1xyXG4gICAgICAgIG5ldyBDaGFuZ2UobWVhc3VyZWRDbGFpbSksXHJcbiAgICAgICAgbmV3IENoYW5nZShjaGlsZENsYWltMSksXHJcbiAgICAgICAgbmV3IENoYW5nZShkZXNjZW5kYW50Q2xhaW0pLFxyXG4gICAgICAgIG5ldyBDaGFuZ2UobmV3IENsYWltRWRnZShtZWFzdXJlZENsYWltLmlkLCBjaGlsZENsYWltMS5pZCwgQWZmZWN0cy5Db25maWRlbmNlLCBmYWxzZSkpLFxyXG4gICAgICAgIG5ldyBDaGFuZ2UobmV3IENsYWltRWRnZShtZWFzdXJlZENsYWltLmlkLCBjaGlsZENsYWltMi5pZCwgQWZmZWN0cy5Db25maWRlbmNlLCB0cnVlKSksXHJcbiAgICAgICAgbmV3IENoYW5nZShuZXcgQ2xhaW1FZGdlKGNoaWxkQ2xhaW0xLmlkLCBkZXNjZW5kYW50Q2xhaW0uaWQsIEFmZmVjdHMuQ29uZmlkZW5jZSwgZmFsc2UpKSxcclxuICAgIF0pO1xyXG4gICAgZXhwZWN0KHJlcG8uZ2V0U2NvcmVCeVNvdXJjZUNsYWltSWQobWVhc3VyZWRDbGFpbS5pZCkuY29uZmlkZW5jZSkudG9CZSgxKTtcclxufSk7XHJcblxyXG50ZXN0KCdNdWx0aXBsZSBjaGlsZHJlbiBjYWxjdWxhdGlvbicsICgpID0+IHtcclxuICAgIGNvbnN0IHJlcG8gPSBuZXcgUmVwb3NpdG9yeSgpO1xyXG4gICAgY29uc3QgY2FsY0luaXRhdG9yID0gbmV3IENhbGN1bGF0aW9uSW5pdGF0b3IocmVwbyk7XHJcbiAgICBjb25zdCBtZWFzdXJlZENsYWltID0gbmV3IENsYWltKFwiTWVhc3VyZWQgQ2xhaW1cIiwgSUQoXCJtZWFzdXJlZENsYWltXCIpKTtcclxuICAgIGNvbnN0IGNoaWxkQ2xhaW0xID0gbmV3IENsYWltKFwiQ2hpbGQgQ2xhaW0gMVwiLCBJRChcImNoaWxkQ2xhaW0xXCIpKTtcclxuICAgIGNvbnN0IGNoaWxkQ2xhaW0yID0gbmV3IENsYWltKFwiQ2hpbGQgQ2xhaW0gMlwiLCBJRChcImNoaWxkQ2xhaW0yXCIpKTtcclxuICAgIGNvbnN0IGRlc2NlbmRhbnRDbGFpbSA9IG5ldyBDbGFpbShcIkRlc2NlbmRhbnQgQ2xhaW1cIiwgSUQoXCJkZXNjZW5kYW50Q2xhaW1cIikpO1xyXG4gICAgY2FsY0luaXRhdG9yLm5vdGlmeShbXHJcbiAgICAgICAgbmV3IENoYW5nZShtZWFzdXJlZENsYWltKSxcclxuICAgICAgICBuZXcgQ2hhbmdlKGNoaWxkQ2xhaW0xKSxcclxuICAgICAgICBuZXcgQ2hhbmdlKGNoaWxkQ2xhaW0yKSxcclxuICAgICAgICBuZXcgQ2hhbmdlKGRlc2NlbmRhbnRDbGFpbSksXHJcbiAgICAgICAgbmV3IENoYW5nZShuZXcgQ2xhaW1FZGdlKG1lYXN1cmVkQ2xhaW0uaWQsIGNoaWxkQ2xhaW0xLmlkLCBBZmZlY3RzLkNvbmZpZGVuY2UsIGZhbHNlKSksXHJcbiAgICAgICAgbmV3IENoYW5nZShuZXcgQ2xhaW1FZGdlKG1lYXN1cmVkQ2xhaW0uaWQsIGNoaWxkQ2xhaW0yLmlkLCBBZmZlY3RzLkNvbmZpZGVuY2UsIGZhbHNlKSksXHJcbiAgICAgICAgbmV3IENoYW5nZShuZXcgQ2xhaW1FZGdlKGNoaWxkQ2xhaW0xLmlkLCBkZXNjZW5kYW50Q2xhaW0uaWQsIEFmZmVjdHMuQ29uZmlkZW5jZSwgZmFsc2UpKSxcclxuICAgIF0pO1xyXG4gICAgZXhwZWN0KHJlcG8uZ2V0U2NvcmVCeVNvdXJjZUNsYWltSWQobWVhc3VyZWRDbGFpbS5pZCkuY29uZmlkZW5jZSkudG9CZSgwKTtcclxufSk7XHJcblxyXG50ZXN0KCdEZWZhdWx0IE5vdCBSZXZlcnNhYmxlJywgKCkgPT4ge1xyXG4gICAgY29uc3QgcmVwbyA9IG5ldyBSZXBvc2l0b3J5KCk7XHJcbiAgICBjb25zdCBjYWxjSW5pdGF0b3IgPSBuZXcgQ2FsY3VsYXRpb25Jbml0YXRvcihyZXBvKTtcclxuICAgIGNvbnN0IG1lYXN1cmVkQ2xhaW0gPSBuZXcgQ2xhaW0oXCJNZWFzdXJlZCBDbGFpbVwiLCBJRChcIm1lYXN1cmVkQ2xhaW1cIikpO1xyXG4gICAgY29uc3QgY2hpbGRDbGFpbTEgPSBuZXcgQ2xhaW0oXCJDaGlsZCBDbGFpbSAxXCIsIElEKFwiY2hpbGRDbGFpbTFcIikpO1xyXG4gICAgY2FsY0luaXRhdG9yLm5vdGlmeShbXHJcbiAgICAgICAgbmV3IENoYW5nZShtZWFzdXJlZENsYWltKSxcclxuICAgICAgICBuZXcgQ2hhbmdlKGNoaWxkQ2xhaW0xKSxcclxuICAgICAgICBuZXcgQ2hhbmdlKG5ldyBDbGFpbUVkZ2UobWVhc3VyZWRDbGFpbS5pZCwgY2hpbGRDbGFpbTEuaWQsIEFmZmVjdHMuQ29uZmlkZW5jZSwgZmFsc2UpKSxcclxuICAgIF0pO1xyXG4gICAgZXhwZWN0KHJlcG8uZ2V0U2NvcmVCeVNvdXJjZUNsYWltSWQobWVhc3VyZWRDbGFpbS5pZCkuY29uZmlkZW5jZSkudG9CZSgwKTtcclxufSk7XHJcblxyXG50ZXN0KCdSZXZlcnNhYmxlJywgKCkgPT4ge1xyXG4gICAgY29uc3QgcmVwbyA9IG5ldyBSZXBvc2l0b3J5KCk7XHJcbiAgICBjb25zdCBjYWxjSW5pdGF0b3IgPSBuZXcgQ2FsY3VsYXRpb25Jbml0YXRvcihyZXBvKTtcclxuICAgIGNvbnN0IG1lYXN1cmVkQ2xhaW0gPSBuZXcgQ2xhaW0oXCJNZWFzdXJlZCBDbGFpbVwiLCBJRChcIm1lYXN1cmVkQ2xhaW1cIiksIHVuZGVmaW5lZCwgdW5kZWZpbmVkLCB1bmRlZmluZWQsIHRydWUpO1xyXG4gICAgY29uc3QgY2hpbGRDbGFpbTEgPSBuZXcgQ2xhaW0oXCJDaGlsZCBDbGFpbSAxXCIsIElEKFwiY2hpbGRDbGFpbTFcIikpO1xyXG4gICAgY2FsY0luaXRhdG9yLm5vdGlmeShbXHJcbiAgICAgICAgbmV3IENoYW5nZShtZWFzdXJlZENsYWltKSxcclxuICAgICAgICBuZXcgQ2hhbmdlKGNoaWxkQ2xhaW0xKSxcclxuICAgICAgICBuZXcgQ2hhbmdlKG5ldyBDbGFpbUVkZ2UobWVhc3VyZWRDbGFpbS5pZCwgY2hpbGRDbGFpbTEuaWQsIEFmZmVjdHMuQ29uZmlkZW5jZSwgZmFsc2UpKSxcclxuICAgIF0pO1xyXG4gICAgZXhwZWN0KHJlcG8uZ2V0U2NvcmVCeVNvdXJjZUNsYWltSWQobWVhc3VyZWRDbGFpbS5pZCkuY29uZmlkZW5jZSkudG9CZSgtMSk7XHJcbn0pOyJdfQ==